{
  "version": 3,
  "sources": ["../../../fast-deep-equal/index.js", "../../../sanity-plugin-utils/src/components/Feedback.tsx", "../../../sanity-plugin-utils/src/components/Table.tsx", "../../../sanity-plugin-utils/src/components/UserSelectMenu/index.tsx", "../../../sanity-plugin-utils/node_modules/@sanity/image-url/lib/node/parseAssetId.js", "../../../sanity-plugin-utils/node_modules/@sanity/image-url/lib/node/parseSource.js", "../../../sanity-plugin-utils/node_modules/@sanity/image-url/lib/node/urlForImage.js", "../../../sanity-plugin-utils/node_modules/@sanity/image-url/lib/node/builder.js", "../../../sanity-plugin-utils/node_modules/@sanity/image-url/lib/node/index.js", "../../../sanity-plugin-utils/src/hooks/useImageUrlBuilder.tsx", "../../../sanity-plugin-utils/src/hooks/useImageUrlBuilderImage.tsx", "../../../sanity-plugin-utils/src/hooks/useListeningQuery.tsx", "../../../sanity-plugin-utils/src/hooks/useOpenInNewPane.tsx", "../../../sanity-plugin-utils/src/hooks/useProjectUsers.tsx", "../../../suspend-react/index.js", "../../../@sanity/language-filter/src/filterField.ts", "../../../@sanity/language-filter/src/useSelectedLanguageIds.ts", "../../../@sanity/language-filter/src/LanguageFilterStudioContext.tsx", "../../../@sanity/language-filter/src/usePaneLanguages.ts", "../../../@sanity/language-filter/src/LanguageFilterMenuButton.tsx", "../../../@sanity/language-filter/src/LanguageFilterObjectInput.tsx", "../../../@sanity/language-filter/src/plugin.tsx", "../../../sanity-plugin-internationalized-array/src/cache.ts", "../../../sanity-plugin-internationalized-array/src/constants.ts", "../../../sanity-plugin-internationalized-array/src/utils/getDocumentsToTranslate.ts", "../../../sanity-plugin-internationalized-array/src/utils/getLanguageDisplay.ts", "../../../sanity-plugin-internationalized-array/src/components/AddButtons.tsx", "../../../sanity-plugin-internationalized-array/src/components/DocumentAddButtons.tsx", "../../../sanity-plugin-internationalized-array/src/components/getSelectedValue.ts", "../../../sanity-plugin-internationalized-array/src/components/InternationalizedArrayContext.tsx", "../../../sanity-plugin-internationalized-array/src/components/InternationalizedField.tsx", "../../../sanity-plugin-internationalized-array/src/components/Preload.tsx", "../../../sanity-plugin-internationalized-array/src/utils/checkAllLanguagesArePresent.ts", "../../../sanity-plugin-internationalized-array/src/utils/createAddAllTitle.ts", "../../../sanity-plugin-internationalized-array/src/utils/createValueSchemaTypeName.ts", "../../../sanity-plugin-internationalized-array/src/utils/createAddLanguagePatches.ts", "../../../sanity-plugin-internationalized-array/src/fieldActions/index.ts", "../../../sanity-plugin-internationalized-array/src/components/createFieldName.ts", "../../../sanity-plugin-internationalized-array/src/components/Feedback.tsx", "../../../sanity-plugin-internationalized-array/src/components/InternationalizedArray.tsx", "../../../sanity-plugin-internationalized-array/src/utils/getLanguagesFieldOption.ts", "../../../sanity-plugin-internationalized-array/src/schema/array.ts", "../../../sanity-plugin-internationalized-array/src/components/getToneFromValidation.ts", "../../../sanity-plugin-internationalized-array/src/components/InternationalizedInput.tsx", "../../../sanity-plugin-internationalized-array/src/schema/object.ts", "../../../sanity-plugin-internationalized-array/src/utils/flattenSchemaType.ts", "../../../sanity-plugin-internationalized-array/src/plugin.tsx", "../../../@sanity/document-internationalization/src/components/DeleteTranslationDialog/DocumentPreview.tsx", "../../../@sanity/document-internationalization/src/constants.ts", "../../../@sanity/document-internationalization/src/components/DeleteTranslationDialog/separateReferences.ts", "../../../@sanity/document-internationalization/src/components/DeleteTranslationDialog/index.tsx", "../../../@sanity/document-internationalization/src/components/DeleteTranslationFooter.tsx", "../../../@sanity/document-internationalization/node_modules/suspend-react/index.js", "../../../@sanity/document-internationalization/src/components/DocumentInternationalizationContext.tsx", "../../../@sanity/document-internationalization/src/actions/DeleteTranslationAction.tsx", "../../../@sanity/document-internationalization/node_modules/tslib/tslib.es6.mjs", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/util/isFunction.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/util/arrRemove.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/Subscription.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/config.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/util/noop.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/Subscriber.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/util/lift.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/util/EmptyError.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/firstValueFrom.js", "../../../@sanity/document-internationalization/node_modules/rxjs/dist/esm5/internal/operators/filter.js", "../../../@sanity/document-internationalization/src/hooks/useLanguageMetadata.tsx", "../../../@sanity/document-internationalization/src/i18n/index.ts", "../../../@sanity/document-internationalization/src/actions/DuplicateWithTranslationsAction.tsx", "../../../@sanity/document-internationalization/src/hooks/useOpenInNewPane.tsx", "../../../@sanity/document-internationalization/src/utils/createReference.ts", "../../../@sanity/document-internationalization/src/components/LanguageManage.tsx", "../../../@sanity/document-internationalization/src/utils/excludePaths.ts", "../../../@sanity/document-internationalization/src/components/LanguageOption.tsx", "../../../@sanity/document-internationalization/src/components/LanguagePatch.tsx", "../../../@sanity/document-internationalization/src/components/ConstrainedBox.tsx", "../../../@sanity/document-internationalization/src/components/Warning.tsx", "../../../@sanity/document-internationalization/src/components/DocumentInternationalizationMenu.tsx", "../../../@sanity/document-internationalization/src/actions/DeleteMetadataAction.tsx", "../../../@sanity/document-internationalization/src/badges/index.tsx", "../../../@sanity/document-internationalization/src/components/BulkPublish/DocumentCheck.tsx", "../../../@sanity/document-internationalization/src/components/BulkPublish/InfoIcon.tsx", "../../../@sanity/document-internationalization/src/components/BulkPublish/Info.tsx", "../../../@sanity/document-internationalization/src/components/BulkPublish/index.tsx", "../../../@sanity/document-internationalization/src/components/OptimisticallyStrengthen/ReferencePatcher.tsx", "../../../@sanity/document-internationalization/src/components/OptimisticallyStrengthen/index.tsx", "../../../@sanity/document-internationalization/src/schema/translation/metadata.ts", "../../../@sanity/document-internationalization/src/plugin.tsx"],
  "sourcesContent": ["'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n", "import {Box, Card, CardTone, Flex, Stack, Text} from '@sanity/ui'\nimport type {ReactNode} from 'react'\n\ntype FeedbackChildren = {\n  children?: ReactNode\n  title?: never\n  description?: never\n}\n\ntype FeedbackTextProps = {\n  title?: string\n  description?: ReactNode\n  children?: never\n}\n\ntype FeedbackProps = (FeedbackChildren | FeedbackTextProps) & {\n  tone?: CardTone\n  icon?: ReactNode\n}\n\nconst DEFAULT_PROPS: FeedbackProps = {\n  tone: 'primary',\n}\n\nexport function Feedback(props: FeedbackProps) {\n  const {title, description, icon, tone, children} = {\n    ...DEFAULT_PROPS,\n    ...props,\n  }\n\n  return (\n    <Card tone={tone} padding={4} radius={3} border>\n      <Flex>\n        {icon ? `display icon` : null}\n        {children ? (\n          children\n        ) : (\n          <Box flex={1}>\n            <Stack space={4}>\n              {title ? <Text weight=\"semibold\">{title}</Text> : null}\n              {description ? <Text size={2}>{description}</Text> : null}\n            </Stack>\n          </Box>\n        )}\n      </Flex>\n    </Card>\n  )\n}\n", "import {Card, type CardProps} from '@sanity/ui'\nimport type {PropsWithChildren} from 'react'\nimport {css, styled} from 'styled-components'\n\n// Wrappers required because of bug with passing down \"as\" prop\n// https://github.com/styled-components/styled-components/issues/2449\n\n// Table\nconst TableWrapper = (props: CardProps = {}) => {\n  return <Card as=\"table\" {...props} />\n}\n\nconst StyledTable = styled(TableWrapper)(\n  () => css`\n    display: table;\n    width: 100%;\n    border-collapse: collapse;\n\n    &:not([hidden]) {\n      display: table;\n      border-collapse: collapse;\n    }\n  `\n)\n\ntype TableProps = PropsWithChildren<CardProps>\n\nexport function Table(props: TableProps) {\n  const {children, ...rest} = props\n\n  return <StyledTable {...rest}>{children}</StyledTable>\n}\n\n// Row\nconst RowWrapper = (props: CardProps = {}) => {\n  return <Card as=\"tr\" {...props} />\n}\n\nconst StyledRow = styled(RowWrapper)(\n  () => css`\n    display: table-row;\n\n    &:not([hidden]) {\n      display: table-row;\n    }\n  `\n)\n\ntype TableRowProps = PropsWithChildren<CardProps>\n\nexport function Row(props: TableRowProps) {\n  const {children, ...rest} = props\n\n  return <StyledRow {...rest}>{children}</StyledRow>\n}\n\n// Cell\nconst CellWrapper = (props = {}) => {\n  return <Card as=\"td\" {...props} />\n}\n\nconst StyledCell = styled(CellWrapper)(\n  () => css`\n    display: table-cell;\n\n    &:not([hidden]) {\n      display: table-cell;\n    }\n  `\n)\n\ntype TableCellProps = PropsWithChildren<\n  CardProps & {\n    colSpan?: number\n    rowSpan?: number\n  }\n>\n\nexport function Cell(props: TableCellProps) {\n  const {children, ...rest} = props\n\n  return <StyledCell {...rest}>{children}</StyledCell>\n}\n", "import {AddCircleIcon, RemoveCircleIcon, RestoreIcon} from '@sanity/icons'\nimport {Badge, Box, Flex, Menu, MenuItem, Text, TextInput} from '@sanity/ui'\nimport {type ChangeEvent, useRef, useState} from 'react'\nimport {UserAvatar} from 'sanity'\n\nimport {UserExtended} from '../../hooks/useProjectUsers'\n\nfunction searchUsers(\n  users: UserExtended[],\n  searchString: string\n): UserExtended[] {\n  return users.filter((user) => {\n    const displayName = (user.displayName || '').toLowerCase()\n    if (displayName.startsWith(searchString)) return true\n    const givenName = (user.givenName || '').toLowerCase()\n    if (givenName.startsWith(searchString)) return true\n    const middleName = (user.middleName || '').toLowerCase()\n    if (middleName.startsWith(searchString)) return true\n    const familyName = (user.familyName || '').toLowerCase()\n    if (familyName.startsWith(searchString)) return true\n\n    return false\n  })\n}\n\ntype Labels = {\n  addMe?: string\n  removeMe?: string\n  clear?: string\n  searchPlaceholder?: string\n  notFound?: string\n}\n\ntype UserSelectMenuProps = {\n  value: string[]\n  userList: UserExtended[]\n  onAdd: (userId: string) => void\n  onRemove: (userId: string) => void\n  onClear: () => void\n  labels?: Labels\n  style?: React.CSSProperties\n}\n\nconst LABELS: Labels = {\n  addMe: 'Assign myself',\n  removeMe: 'Unassign myself',\n  clear: 'Clear assignees',\n  searchPlaceholder: 'Search users',\n  notFound: 'No users found',\n}\n\nexport function UserSelectMenu(props: UserSelectMenuProps) {\n  const {\n    value = [],\n    userList = [],\n    onAdd,\n    onRemove,\n    onClear,\n    style = {},\n  } = props\n  const labels = props?.labels ? {...LABELS, ...props.labels} : LABELS\n\n  const [searchString, setSearchString] = useState('')\n  const searchResults = searchUsers(userList || [], searchString)\n\n  const me = userList.find((u) => u.isCurrentUser)\n  const meAssigned = me && value.includes(me.id)\n\n  // Focus input on open\n  // TODO: Fix focus, it gets immediately taken away\n  const input = useRef<HTMLInputElement>(null)\n  // useEffect(() => {\n  //   if (open && input?.current) {\n  //     input.current.focus()\n  //   }\n  // }, [open])\n\n  const handleSearchChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setSearchString(event.target.value)\n  }\n\n  const handleSelect = (isChecked: boolean, user: UserExtended) => {\n    if (!isChecked) {\n      if (onAdd) onAdd(user.id)\n    } else if (onRemove) onRemove(user.id)\n  }\n\n  const handleAssignMyself = () => {\n    if (me && onAdd) onAdd(me.id)\n  }\n\n  const handleUnassignMyself = () => {\n    if (me && onRemove) onRemove(me.id)\n  }\n\n  const handleClearAssigneesClick = () => {\n    if (onClear) onClear()\n  }\n\n  return (\n    <Menu style={style}>\n      {meAssigned ? (\n        <MenuItem\n          tone=\"caution\"\n          disabled={!me}\n          onClick={handleUnassignMyself}\n          icon={RemoveCircleIcon}\n          text={labels.removeMe}\n        />\n      ) : (\n        <MenuItem\n          tone=\"positive\"\n          onClick={handleAssignMyself}\n          icon={AddCircleIcon}\n          text={labels.addMe}\n        />\n      )}\n\n      <MenuItem\n        tone=\"critical\"\n        disabled={value.length === 0}\n        onClick={handleClearAssigneesClick}\n        icon={RestoreIcon}\n        text={labels.clear}\n      />\n\n      <Box padding={1}>\n        <TextInput\n          ref={input}\n          onChange={handleSearchChange}\n          placeholder={labels.searchPlaceholder}\n          value={searchString}\n        />\n      </Box>\n\n      {searchString && searchResults?.length === 0 && (\n        <MenuItem disabled text={labels.notFound} />\n      )}\n\n      {searchResults &&\n        searchResults.map((user) => (\n          <MenuItem\n            key={user.id}\n            pressed={value.includes(user.id)}\n            onClick={() => handleSelect(value.indexOf(user.id) > -1, user)}\n          >\n            <Flex align=\"center\">\n              <UserAvatar user={user} size={1} />\n              <Box paddingX={2} flex={1}>\n                <Text>{user.displayName}</Text>\n              </Box>\n              {user.isCurrentUser && (\n                <Badge fontSize={1} tone=\"positive\" mode=\"outline\">\n                  Me\n                </Badge>\n              )}\n            </Flex>\n          </MenuItem>\n        ))}\n    </Menu>\n  )\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar example = 'image-Tb9Ew8CXIwaY6R1kjMvI0uRR-2000x3000-jpg';\nfunction parseAssetId(ref) {\n    var _a = ref.split('-'), id = _a[1], dimensionString = _a[2], format = _a[3];\n    if (!id || !dimensionString || !format) {\n        throw new Error(\"Malformed asset _ref '\".concat(ref, \"'. Expected an id like \\\"\").concat(example, \"\\\".\"));\n    }\n    var _b = dimensionString.split('x'), imgWidthStr = _b[0], imgHeightStr = _b[1];\n    var width = +imgWidthStr;\n    var height = +imgHeightStr;\n    var isValidAssetId = isFinite(width) && isFinite(height);\n    if (!isValidAssetId) {\n        throw new Error(\"Malformed asset _ref '\".concat(ref, \"'. Expected an id like \\\"\").concat(example, \"\\\".\"));\n    }\n    return { id: id, width: width, height: height, format: format };\n}\nexports.default = parseAssetId;\n//# sourceMappingURL=parseAssetId.js.map", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar isRef = function (src) {\n    var source = src;\n    return source ? typeof source._ref === 'string' : false;\n};\nvar isAsset = function (src) {\n    var source = src;\n    return source ? typeof source._id === 'string' : false;\n};\nvar isAssetStub = function (src) {\n    var source = src;\n    return source && source.asset ? typeof source.asset.url === 'string' : false;\n};\n// Convert an asset-id, asset or image to an image record suitable for processing\n// eslint-disable-next-line complexity\nfunction parseSource(source) {\n    if (!source) {\n        return null;\n    }\n    var image;\n    if (typeof source === 'string' && isUrl(source)) {\n        // Someone passed an existing image url?\n        image = {\n            asset: { _ref: urlToId(source) },\n        };\n    }\n    else if (typeof source === 'string') {\n        // Just an asset id\n        image = {\n            asset: { _ref: source },\n        };\n    }\n    else if (isRef(source)) {\n        // We just got passed an asset directly\n        image = {\n            asset: source,\n        };\n    }\n    else if (isAsset(source)) {\n        // If we were passed an image asset document\n        image = {\n            asset: {\n                _ref: source._id || '',\n            },\n        };\n    }\n    else if (isAssetStub(source)) {\n        // If we were passed a partial asset (`url`, but no `_id`)\n        image = {\n            asset: {\n                _ref: urlToId(source.asset.url),\n            },\n        };\n    }\n    else if (typeof source.asset === 'object') {\n        // Probably an actual image with materialized asset\n        image = __assign({}, source);\n    }\n    else {\n        // We got something that does not look like an image, or it is an image\n        // that currently isn't sporting an asset.\n        return null;\n    }\n    var img = source;\n    if (img.crop) {\n        image.crop = img.crop;\n    }\n    if (img.hotspot) {\n        image.hotspot = img.hotspot;\n    }\n    return applyDefaults(image);\n}\nexports.default = parseSource;\nfunction isUrl(url) {\n    return /^https?:\\/\\//.test(\"\".concat(url));\n}\nfunction urlToId(url) {\n    var parts = url.split('/').slice(-1);\n    return \"image-\".concat(parts[0]).replace(/\\.([a-z]+)$/, '-$1');\n}\n// Mock crop and hotspot if image lacks it\nfunction applyDefaults(image) {\n    if (image.crop && image.hotspot) {\n        return image;\n    }\n    // We need to pad in default values for crop or hotspot\n    var result = __assign({}, image);\n    if (!result.crop) {\n        result.crop = {\n            left: 0,\n            top: 0,\n            bottom: 0,\n            right: 0,\n        };\n    }\n    if (!result.hotspot) {\n        result.hotspot = {\n            x: 0.5,\n            y: 0.5,\n            height: 1.0,\n            width: 1.0,\n        };\n    }\n    return result;\n}\n//# sourceMappingURL=parseSource.js.map", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.parseSource = exports.SPEC_NAME_TO_URL_NAME_MAPPINGS = void 0;\nvar parseAssetId_1 = __importDefault(require(\"./parseAssetId\"));\nvar parseSource_1 = __importDefault(require(\"./parseSource\"));\nexports.parseSource = parseSource_1.default;\nexports.SPEC_NAME_TO_URL_NAME_MAPPINGS = [\n    ['width', 'w'],\n    ['height', 'h'],\n    ['format', 'fm'],\n    ['download', 'dl'],\n    ['blur', 'blur'],\n    ['sharpen', 'sharp'],\n    ['invert', 'invert'],\n    ['orientation', 'or'],\n    ['minHeight', 'min-h'],\n    ['maxHeight', 'max-h'],\n    ['minWidth', 'min-w'],\n    ['maxWidth', 'max-w'],\n    ['quality', 'q'],\n    ['fit', 'fit'],\n    ['crop', 'crop'],\n    ['saturation', 'sat'],\n    ['auto', 'auto'],\n    ['dpr', 'dpr'],\n    ['pad', 'pad'],\n];\nfunction urlForImage(options) {\n    var spec = __assign({}, (options || {}));\n    var source = spec.source;\n    delete spec.source;\n    var image = (0, parseSource_1.default)(source);\n    if (!image) {\n        throw new Error(\"Unable to resolve image URL from source (\".concat(JSON.stringify(source), \")\"));\n    }\n    var id = image.asset._ref || image.asset._id || '';\n    var asset = (0, parseAssetId_1.default)(id);\n    // Compute crop rect in terms of pixel coordinates in the raw source image\n    var cropLeft = Math.round(image.crop.left * asset.width);\n    var cropTop = Math.round(image.crop.top * asset.height);\n    var crop = {\n        left: cropLeft,\n        top: cropTop,\n        width: Math.round(asset.width - image.crop.right * asset.width - cropLeft),\n        height: Math.round(asset.height - image.crop.bottom * asset.height - cropTop),\n    };\n    // Compute hot spot rect in terms of pixel coordinates\n    var hotSpotVerticalRadius = (image.hotspot.height * asset.height) / 2;\n    var hotSpotHorizontalRadius = (image.hotspot.width * asset.width) / 2;\n    var hotSpotCenterX = image.hotspot.x * asset.width;\n    var hotSpotCenterY = image.hotspot.y * asset.height;\n    var hotspot = {\n        left: hotSpotCenterX - hotSpotHorizontalRadius,\n        top: hotSpotCenterY - hotSpotVerticalRadius,\n        right: hotSpotCenterX + hotSpotHorizontalRadius,\n        bottom: hotSpotCenterY + hotSpotVerticalRadius,\n    };\n    // If irrelevant, or if we are requested to: don't perform crop/fit based on\n    // the crop/hotspot.\n    if (!(spec.rect || spec.focalPoint || spec.ignoreImageParams || spec.crop)) {\n        spec = __assign(__assign({}, spec), fit({ crop: crop, hotspot: hotspot }, spec));\n    }\n    return specToImageUrl(__assign(__assign({}, spec), { asset: asset }));\n}\nexports.default = urlForImage;\n// eslint-disable-next-line complexity\nfunction specToImageUrl(spec) {\n    var cdnUrl = (spec.baseUrl || 'https://cdn.sanity.io').replace(/\\/+$/, '');\n    var filename = \"\".concat(spec.asset.id, \"-\").concat(spec.asset.width, \"x\").concat(spec.asset.height, \".\").concat(spec.asset.format);\n    var baseUrl = \"\".concat(cdnUrl, \"/images/\").concat(spec.projectId, \"/\").concat(spec.dataset, \"/\").concat(filename);\n    var params = [];\n    if (spec.rect) {\n        // Only bother url with a crop if it actually crops anything\n        var _a = spec.rect, left = _a.left, top_1 = _a.top, width = _a.width, height = _a.height;\n        var isEffectiveCrop = left !== 0 || top_1 !== 0 || height !== spec.asset.height || width !== spec.asset.width;\n        if (isEffectiveCrop) {\n            params.push(\"rect=\".concat(left, \",\").concat(top_1, \",\").concat(width, \",\").concat(height));\n        }\n    }\n    if (spec.bg) {\n        params.push(\"bg=\".concat(spec.bg));\n    }\n    if (spec.focalPoint) {\n        params.push(\"fp-x=\".concat(spec.focalPoint.x));\n        params.push(\"fp-y=\".concat(spec.focalPoint.y));\n    }\n    var flip = [spec.flipHorizontal && 'h', spec.flipVertical && 'v'].filter(Boolean).join('');\n    if (flip) {\n        params.push(\"flip=\".concat(flip));\n    }\n    // Map from spec name to url param name, and allow using the actual param name as an alternative\n    exports.SPEC_NAME_TO_URL_NAME_MAPPINGS.forEach(function (mapping) {\n        var specName = mapping[0], param = mapping[1];\n        if (typeof spec[specName] !== 'undefined') {\n            params.push(\"\".concat(param, \"=\").concat(encodeURIComponent(spec[specName])));\n        }\n        else if (typeof spec[param] !== 'undefined') {\n            params.push(\"\".concat(param, \"=\").concat(encodeURIComponent(spec[param])));\n        }\n    });\n    if (params.length === 0) {\n        return baseUrl;\n    }\n    return \"\".concat(baseUrl, \"?\").concat(params.join('&'));\n}\nfunction fit(source, spec) {\n    var cropRect;\n    var imgWidth = spec.width;\n    var imgHeight = spec.height;\n    // If we are not constraining the aspect ratio, we'll just use the whole crop\n    if (!(imgWidth && imgHeight)) {\n        return { width: imgWidth, height: imgHeight, rect: source.crop };\n    }\n    var crop = source.crop;\n    var hotspot = source.hotspot;\n    // If we are here, that means aspect ratio is locked and fitting will be a bit harder\n    var desiredAspectRatio = imgWidth / imgHeight;\n    var cropAspectRatio = crop.width / crop.height;\n    if (cropAspectRatio > desiredAspectRatio) {\n        // The crop is wider than the desired aspect ratio. That means we are cutting from the sides\n        var height = Math.round(crop.height);\n        var width = Math.round(height * desiredAspectRatio);\n        var top_2 = Math.max(0, Math.round(crop.top));\n        // Center output horizontally over hotspot\n        var hotspotXCenter = Math.round((hotspot.right - hotspot.left) / 2 + hotspot.left);\n        var left = Math.max(0, Math.round(hotspotXCenter - width / 2));\n        // Keep output within crop\n        if (left < crop.left) {\n            left = crop.left;\n        }\n        else if (left + width > crop.left + crop.width) {\n            left = crop.left + crop.width - width;\n        }\n        cropRect = { left: left, top: top_2, width: width, height: height };\n    }\n    else {\n        // The crop is taller than the desired ratio, we are cutting from top and bottom\n        var width = crop.width;\n        var height = Math.round(width / desiredAspectRatio);\n        var left = Math.max(0, Math.round(crop.left));\n        // Center output vertically over hotspot\n        var hotspotYCenter = Math.round((hotspot.bottom - hotspot.top) / 2 + hotspot.top);\n        var top_3 = Math.max(0, Math.round(hotspotYCenter - height / 2));\n        // Keep output rect within crop\n        if (top_3 < crop.top) {\n            top_3 = crop.top;\n        }\n        else if (top_3 + height > crop.top + crop.height) {\n            top_3 = crop.top + crop.height - height;\n        }\n        cropRect = { left: left, top: top_3, width: width, height: height };\n    }\n    return {\n        width: imgWidth,\n        height: imgHeight,\n        rect: cropRect,\n    };\n}\n//# sourceMappingURL=urlForImage.js.map", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ImageUrlBuilder = void 0;\nvar urlForImage_1 = __importStar(require(\"./urlForImage\"));\nvar validFits = ['clip', 'crop', 'fill', 'fillmax', 'max', 'scale', 'min'];\nvar validCrops = ['top', 'bottom', 'left', 'right', 'center', 'focalpoint', 'entropy'];\nvar validAutoModes = ['format'];\nfunction isSanityModernClientLike(client) {\n    return client && 'config' in client ? typeof client.config === 'function' : false;\n}\nfunction isSanityClientLike(client) {\n    return client && 'clientConfig' in client ? typeof client.clientConfig === 'object' : false;\n}\nfunction rewriteSpecName(key) {\n    var specs = urlForImage_1.SPEC_NAME_TO_URL_NAME_MAPPINGS;\n    for (var _i = 0, specs_1 = specs; _i < specs_1.length; _i++) {\n        var entry = specs_1[_i];\n        var specName = entry[0], param = entry[1];\n        if (key === specName || key === param) {\n            return specName;\n        }\n    }\n    return key;\n}\nfunction urlBuilder(options) {\n    // Did we get a modernish client?\n    if (isSanityModernClientLike(options)) {\n        // Inherit config from client\n        var _a = options.config(), apiUrl = _a.apiHost, projectId = _a.projectId, dataset = _a.dataset;\n        var apiHost = apiUrl || 'https://api.sanity.io';\n        return new ImageUrlBuilder(null, {\n            baseUrl: apiHost.replace(/^https:\\/\\/api\\./, 'https://cdn.'),\n            projectId: projectId,\n            dataset: dataset,\n        });\n    }\n    // Did we get a SanityClient?\n    var client = options;\n    if (isSanityClientLike(client)) {\n        // Inherit config from client\n        var _b = client.clientConfig, apiUrl = _b.apiHost, projectId = _b.projectId, dataset = _b.dataset;\n        var apiHost = apiUrl || 'https://api.sanity.io';\n        return new ImageUrlBuilder(null, {\n            baseUrl: apiHost.replace(/^https:\\/\\/api\\./, 'https://cdn.'),\n            projectId: projectId,\n            dataset: dataset,\n        });\n    }\n    // Or just accept the options as given\n    return new ImageUrlBuilder(null, options);\n}\nexports.default = urlBuilder;\nvar ImageUrlBuilder = /** @class */ (function () {\n    function ImageUrlBuilder(parent, options) {\n        this.options = parent\n            ? __assign(__assign({}, (parent.options || {})), (options || {})) : __assign({}, (options || {})); // Copy options\n    }\n    ImageUrlBuilder.prototype.withOptions = function (options) {\n        var baseUrl = options.baseUrl || this.options.baseUrl;\n        var newOptions = { baseUrl: baseUrl };\n        for (var key in options) {\n            if (options.hasOwnProperty(key)) {\n                var specKey = rewriteSpecName(key);\n                newOptions[specKey] = options[key];\n            }\n        }\n        return new ImageUrlBuilder(this, __assign({ baseUrl: baseUrl }, newOptions));\n    };\n    // The image to be represented. Accepts a Sanity 'image'-document, 'asset'-document or\n    // _id of asset. To get the benefit of automatic hot-spot/crop integration with the content\n    // studio, the 'image'-document must be provided.\n    ImageUrlBuilder.prototype.image = function (source) {\n        return this.withOptions({ source: source });\n    };\n    // Specify the dataset\n    ImageUrlBuilder.prototype.dataset = function (dataset) {\n        return this.withOptions({ dataset: dataset });\n    };\n    // Specify the projectId\n    ImageUrlBuilder.prototype.projectId = function (projectId) {\n        return this.withOptions({ projectId: projectId });\n    };\n    // Specify background color\n    ImageUrlBuilder.prototype.bg = function (bg) {\n        return this.withOptions({ bg: bg });\n    };\n    // Set DPR scaling factor\n    ImageUrlBuilder.prototype.dpr = function (dpr) {\n        // A DPR of 1 is the default - so only include it if we have a different value\n        return this.withOptions(dpr && dpr !== 1 ? { dpr: dpr } : {});\n    };\n    // Specify the width of the image in pixels\n    ImageUrlBuilder.prototype.width = function (width) {\n        return this.withOptions({ width: width });\n    };\n    // Specify the height of the image in pixels\n    ImageUrlBuilder.prototype.height = function (height) {\n        return this.withOptions({ height: height });\n    };\n    // Specify focal point in fraction of image dimensions. Each component 0.0-1.0\n    ImageUrlBuilder.prototype.focalPoint = function (x, y) {\n        return this.withOptions({ focalPoint: { x: x, y: y } });\n    };\n    ImageUrlBuilder.prototype.maxWidth = function (maxWidth) {\n        return this.withOptions({ maxWidth: maxWidth });\n    };\n    ImageUrlBuilder.prototype.minWidth = function (minWidth) {\n        return this.withOptions({ minWidth: minWidth });\n    };\n    ImageUrlBuilder.prototype.maxHeight = function (maxHeight) {\n        return this.withOptions({ maxHeight: maxHeight });\n    };\n    ImageUrlBuilder.prototype.minHeight = function (minHeight) {\n        return this.withOptions({ minHeight: minHeight });\n    };\n    // Specify width and height in pixels\n    ImageUrlBuilder.prototype.size = function (width, height) {\n        return this.withOptions({ width: width, height: height });\n    };\n    // Specify blur between 0 and 100\n    ImageUrlBuilder.prototype.blur = function (blur) {\n        return this.withOptions({ blur: blur });\n    };\n    ImageUrlBuilder.prototype.sharpen = function (sharpen) {\n        return this.withOptions({ sharpen: sharpen });\n    };\n    // Specify the desired rectangle of the image\n    ImageUrlBuilder.prototype.rect = function (left, top, width, height) {\n        return this.withOptions({ rect: { left: left, top: top, width: width, height: height } });\n    };\n    // Specify the image format of the image. 'jpg', 'pjpg', 'png', 'webp'\n    ImageUrlBuilder.prototype.format = function (format) {\n        return this.withOptions({ format: format });\n    };\n    ImageUrlBuilder.prototype.invert = function (invert) {\n        return this.withOptions({ invert: invert });\n    };\n    // Rotation in degrees 0, 90, 180, 270\n    ImageUrlBuilder.prototype.orientation = function (orientation) {\n        return this.withOptions({ orientation: orientation });\n    };\n    // Compression quality 0-100\n    ImageUrlBuilder.prototype.quality = function (quality) {\n        return this.withOptions({ quality: quality });\n    };\n    // Make it a download link. Parameter is default filename.\n    ImageUrlBuilder.prototype.forceDownload = function (download) {\n        return this.withOptions({ download: download });\n    };\n    // Flip image horizontally\n    ImageUrlBuilder.prototype.flipHorizontal = function () {\n        return this.withOptions({ flipHorizontal: true });\n    };\n    // Flip image vertically\n    ImageUrlBuilder.prototype.flipVertical = function () {\n        return this.withOptions({ flipVertical: true });\n    };\n    // Ignore crop/hotspot from image record, even when present\n    ImageUrlBuilder.prototype.ignoreImageParams = function () {\n        return this.withOptions({ ignoreImageParams: true });\n    };\n    ImageUrlBuilder.prototype.fit = function (value) {\n        if (validFits.indexOf(value) === -1) {\n            throw new Error(\"Invalid fit mode \\\"\".concat(value, \"\\\"\"));\n        }\n        return this.withOptions({ fit: value });\n    };\n    ImageUrlBuilder.prototype.crop = function (value) {\n        if (validCrops.indexOf(value) === -1) {\n            throw new Error(\"Invalid crop mode \\\"\".concat(value, \"\\\"\"));\n        }\n        return this.withOptions({ crop: value });\n    };\n    // Saturation\n    ImageUrlBuilder.prototype.saturation = function (saturation) {\n        return this.withOptions({ saturation: saturation });\n    };\n    ImageUrlBuilder.prototype.auto = function (value) {\n        if (validAutoModes.indexOf(value) === -1) {\n            throw new Error(\"Invalid auto mode \\\"\".concat(value, \"\\\"\"));\n        }\n        return this.withOptions({ auto: value });\n    };\n    // Specify the number of pixels to pad the image\n    ImageUrlBuilder.prototype.pad = function (pad) {\n        return this.withOptions({ pad: pad });\n    };\n    // Gets the url based on the submitted parameters\n    ImageUrlBuilder.prototype.url = function () {\n        return (0, urlForImage_1.default)(this.options);\n    };\n    // Alias for url()\n    ImageUrlBuilder.prototype.toString = function () {\n        return this.url();\n    };\n    return ImageUrlBuilder;\n}());\nexports.ImageUrlBuilder = ImageUrlBuilder;\n//# sourceMappingURL=builder.js.map", "\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar builder_1 = __importDefault(require(\"./builder\"));\nmodule.exports = builder_1.default;\n//# sourceMappingURL=index.js.map", "import createImageUrlBuilder from '@sanity/image-url'\nimport {useMemo} from 'react'\nimport type {ImageUrlBuilder, SourceClientOptions} from 'sanity'\nimport {useClient} from 'sanity'\n\nexport function useImageUrlBuilder(\n  clientOptions?: SourceClientOptions\n): ImageUrlBuilder | null {\n  const client = useClient(clientOptions)\n  const builder = useMemo(() => createImageUrlBuilder(client), [client])\n\n  return builder\n}\n", "import type {SanityImageSource} from '@sanity/asset-utils'\nimport {useMemo} from 'react'\nimport type {ImageUrlBuilder, SourceClientOptions} from 'sanity'\n\nimport {useImageUrlBuilder} from './useImageUrlBuilder'\n\nexport function useImageUrlBuilderImage(\n  source: SanityImageSource,\n  clientOptions?: SourceClientOptions\n): ImageUrlBuilder | null {\n  const builder = useImageUrlBuilder(clientOptions)\n  const image = useMemo(\n    () => (source && builder ? builder.image(source) : null),\n    [builder, source]\n  )\n\n  return image\n}\n", "import {useEffect, useMemo, useRef, useState} from 'react'\nimport isEqual from 'react-fast-compare'\nimport {Subscription} from 'rxjs'\nimport {catchError, distinctUntilChanged} from 'rxjs/operators'\nimport {ListenQueryOptions, ListenQueryParams, useDocumentStore} from 'sanity'\n\ntype Value = unknown\n\ninterface Config<V> {\n  params?: ListenQueryParams\n  options?: ListenQueryOptions\n  initialValue?: null | V\n}\n\n// make generic optional\ninterface Return<V = Value> {\n  loading: boolean\n  error: boolean | unknown | ProgressEvent\n  data: unknown | V\n  initialValue?: Value\n}\n\nconst DEFAULT_PARAMS = {}\nconst DEFAULT_OPTIONS = {apiVersion: `v2023-05-01`}\nconst DEFAULT_INITIAL_VALUE = null\n\nfunction useParams(\n  params?: undefined | null | ListenQueryParams | ListenQueryOptions\n): ListenQueryParams {\n  const stringifiedParams = useMemo(\n    () => JSON.stringify(params || {}),\n    [params]\n  )\n  return useMemo(() => JSON.parse(stringifiedParams), [stringifiedParams])\n}\n\nexport function useListeningQuery<V>(\n  query: string | {fetch: string; listen: string},\n  {\n    params = DEFAULT_PARAMS,\n    options = DEFAULT_OPTIONS,\n    initialValue = DEFAULT_INITIAL_VALUE,\n  }: Config<V>\n): Return<V> {\n  const [loading, setLoading] = useState<Return['loading']>(true)\n  const [error, setError] = useState<Return['error']>(false)\n  const [data, setData] = useState<Return['data']>(initialValue)\n  const memoParams = useParams(params)\n  const memoOptions = useParams(options)\n\n  const subscription = useRef<null | Subscription>(null)\n  const documentStore = useDocumentStore()\n\n  useEffect(() => {\n    if (query && !error && !subscription.current) {\n      try {\n        subscription.current = documentStore\n          .listenQuery(query, memoParams, memoOptions)\n          .pipe(\n            distinctUntilChanged(isEqual),\n            catchError((err) => {\n              console.error(err)\n              setError(err)\n              setLoading(false)\n              setData(null)\n\n              return err\n            })\n          )\n          .subscribe((documents) => {\n            setData((current: Value) =>\n              isEqual(current, documents) ? current : documents\n            )\n            setLoading(false)\n            setError(false)\n          })\n      } catch (err) {\n        console.error(err)\n        setLoading(false)\n        setError(err)\n      }\n    }\n\n    // Unsubscribe when an error occurs\n    if (error && subscription.current) {\n      subscription.current.unsubscribe()\n    }\n\n    return () => {\n      if (subscription.current) {\n        subscription?.current?.unsubscribe()\n        subscription.current = null\n      }\n    }\n  }, [query, error, memoParams, memoOptions, documentStore])\n\n  return {data, loading, error}\n}\n", "import {useCallback, useContext} from 'react'\nimport {RouterContext} from 'sanity/router'\nimport {usePaneRouter} from 'sanity/structure'\n\nexport function useOpenInNewPane(id?: string, type?: string) {\n  const routerContext = useContext(RouterContext)\n  const {routerPanesState, groupIndex} = usePaneRouter()\n\n  const openInNewPane = useCallback(() => {\n    if (!routerContext || !id || !type) {\n      return\n    }\n\n    const panes = [...routerPanesState]\n    panes.splice(groupIndex + 1, 0, [\n      {\n        id: id,\n        params: {type},\n      },\n    ])\n\n    const href = routerContext.resolvePathFromState({panes})\n    routerContext.navigateUrl({path: href})\n  }, [id, type, routerContext, routerPanesState, groupIndex])\n\n  return openInNewPane\n}\n", "import {useEffect, useState} from 'react'\nimport {useClient, useWorkspace} from 'sanity'\n\nexport type UserExtended = {\n  createdAt: string\n  displayName: string\n  email: string\n  familyName: string\n  givenName: string\n  id: string\n  imageUrl: string\n  isCurrentUser: boolean\n  middleName: string\n  projectId: string\n  provider: string\n  sanityUserId: string\n  updatedAt: string\n}\n\ntype UserRole = {\n  name: string\n  title: string\n}\n\ntype UserResponse = {\n  isRobot: boolean\n  projectUserId: string\n  roles: UserRole[]\n}\n\ntype HookConfig = {\n  apiVersion?: string\n}\n\nfunction chunkArray<T>(array: T[], size: number): T[][] {\n  const chunks: T[][] = []\n  for (let i = 0; i < array.length; i += size) {\n    chunks.push(array.slice(i, i + size))\n  }\n  return chunks\n}\n\n// Custom hook to fetch user details and roles in batches\nexport function useProjectUsers({apiVersion}: HookConfig): UserExtended[] {\n  const {currentUser} = useWorkspace()\n  const client = useClient({apiVersion: apiVersion ?? '2023-01-01'})\n  const [users, setUsers] = useState<UserExtended[]>([])\n\n  useEffect(() => {\n    const {projectId} = client.config()\n\n    async function getUsersWithRoles() {\n      try {\n        const aclData = await client.request({\n          url: `/projects/${projectId}/acl`,\n        })\n\n        const userIds = aclData.map((user: UserResponse) => user.projectUserId)\n\n        const userIdChunks = chunkArray(userIds, 200)\n\n        let usersData: UserExtended[] = []\n\n        // Fetch users in batches of 200\n        for (const chunk of userIdChunks) {\n          const chunkedUserIds = chunk.join(',')\n          const response = await client.request({\n            url: `/projects/${projectId}/users/${chunkedUserIds}`,\n          })\n          usersData = [...usersData, ...response]\n        }\n\n        // Combine user details with roles\n        const usersWithRoles = usersData.map((user: UserExtended) => {\n          const userRoles =\n            aclData.find(\n              (aclUser: UserResponse) => aclUser.projectUserId === user.id\n            )?.roles || []\n\n          return {\n            ...user,\n            isCurrentUser: user.id === currentUser?.id,\n            roles: userRoles,\n          }\n        })\n\n        setUsers(usersWithRoles)\n      } catch (err) {\n        console.error('Failed to fetch users:', err)\n      }\n    }\n\n    if (!users.length) {\n      getUsersWithRoles()\n    }\n  }, [client, currentUser?.id, users.length])\n\n  return users\n}\n", "const isPromise = promise => typeof promise === 'object' && typeof promise.then === 'function';\n\nconst globalCache = [];\n\nfunction shallowEqualArrays(arrA, arrB, equal = (a, b) => a === b) {\n  if (arrA === arrB) return true;\n  if (!arrA || !arrB) return false;\n  const len = arrA.length;\n  if (arrB.length !== len) return false;\n\n  for (let i = 0; i < len; i++) if (!equal(arrA[i], arrB[i])) return false;\n\n  return true;\n}\n\nfunction query(fn, keys = null, preload = false, config = {}) {\n  // If no keys were given, the function is the key\n  if (keys === null) keys = [fn];\n\n  for (const entry of globalCache) {\n    // Find a match\n    if (shallowEqualArrays(keys, entry.keys, entry.equal)) {\n      // If we're pre-loading and the element is present, just return\n      if (preload) return undefined; // If an error occurred, throw\n\n      if (Object.prototype.hasOwnProperty.call(entry, 'error')) throw entry.error; // If a response was successful, return\n\n      if (Object.prototype.hasOwnProperty.call(entry, 'response')) {\n        if (config.lifespan && config.lifespan > 0) {\n          if (entry.timeout) clearTimeout(entry.timeout);\n          entry.timeout = setTimeout(entry.remove, config.lifespan);\n        }\n\n        return entry.response;\n      } // If the promise is still unresolved, throw\n\n\n      if (!preload) throw entry.promise;\n    }\n  } // The request is new or has changed.\n\n\n  const entry = {\n    keys,\n    equal: config.equal,\n    remove: () => {\n      const index = globalCache.indexOf(entry);\n      if (index !== -1) globalCache.splice(index, 1);\n    },\n    promise: // Execute the promise\n    (isPromise(fn) ? fn : fn(...keys) // When it resolves, store its value\n    ).then(response => {\n      entry.response = response; // Remove the entry in time if a lifespan was given\n\n      if (config.lifespan && config.lifespan > 0) {\n        entry.timeout = setTimeout(entry.remove, config.lifespan);\n      }\n    }) // Store caught errors, they will be thrown in the render-phase to bubble into an error-bound\n    .catch(error => entry.error = error)\n  }; // Register the entry\n\n  globalCache.push(entry); // And throw the promise, this yields control back to React\n\n  if (!preload) throw entry.promise;\n  return undefined;\n}\n\nconst suspend = (fn, keys, config) => query(fn, keys, false, config);\n\nconst preload = (fn, keys, config) => void query(fn, keys, true, config);\n\nconst peek = keys => {\n  var _globalCache$find;\n\n  return (_globalCache$find = globalCache.find(entry => shallowEqualArrays(keys, entry.keys, entry.equal))) == null ? void 0 : _globalCache$find.response;\n};\n\nconst clear = keys => {\n  if (keys === undefined || keys.length === 0) globalCache.splice(0, globalCache.length);else {\n    const entry = globalCache.find(entry => shallowEqualArrays(keys, entry.keys, entry.equal));\n    if (entry) entry.remove();\n  }\n};\n\nexport { clear, peek, preload, suspend };\n", "import type {SchemaType} from 'sanity'\n\nimport type {FilterFieldFunction, LanguageFilterConfig, LanguageFilterSchema} from './types'\n\nexport const defaultFilterField: FilterFieldFunction = (\n  enclosingType,\n  field,\n  selectedLanguageIds,\n) => !enclosingType.name.startsWith('locale') || selectedLanguageIds.includes(field.name)\n\nexport function isLanguageFilterEnabled(\n  schemaType: SchemaType | undefined,\n  options: LanguageFilterConfig,\n): boolean {\n  const schemaFilter =\n    isDocument(schemaType) && (schemaType as LanguageFilterSchema)?.options?.languageFilter\n  const defaultEnabled = !options.documentTypes\n\n  return !!(\n    (defaultEnabled && schemaFilter !== false) ||\n    (!defaultEnabled && schemaFilter) ||\n    (schemaType && options.documentTypes?.includes(schemaType.name))\n  )\n}\n\nfunction isDocument(schemaType?: SchemaType) {\n  return schemaType?.jsonType === 'object' && getRootType(schemaType).name === 'document'\n}\n\nfunction getRootType(schema: SchemaType): SchemaType {\n  if (schema.type) {\n    return getRootType(schema.type)\n  }\n  return schema\n}\n", "import {useState} from 'react'\n\nimport type {Language, LanguageFilterConfig} from './types'\nconst storageKey = '@sanity/plugin/language-filter/selected-languages'\n\nexport function getPersistedLanguageIds(options: LanguageFilterConfig): string[] {\n  const selectableLangs = getSelectableLanguages(options).map((l) => l.id)\n\n  let selected: string[] = selectableLangs\n  try {\n    const persistedValue = window.localStorage.getItem(storageKey)\n    if (persistedValue) {\n      selected = JSON.parse(persistedValue)\n    }\n  } catch (err) {} // eslint-disable-line no-empty\n\n  // constrain persisted/selected languages to the ones currently supported\n  selected = intersection(selected, selectableLangs)\n  return selected\n}\n\nexport function persistLanguageIds(languageIds: string[]): void {\n  window.localStorage.setItem(storageKey, JSON.stringify(languageIds))\n}\n\nfunction intersection(array1: string[], array2: string[]) {\n  return array1.filter((value) => array2.includes(value))\n}\n\nexport function getSelectableLanguages({\n  supportedLanguages,\n  defaultLanguages,\n}: LanguageFilterConfig): Language[] {\n  return Array.isArray(supportedLanguages)\n    ? supportedLanguages.filter((lang) => !defaultLanguages?.includes(lang.id))\n    : []\n}\n\nexport function useSelectedLanguageIds(\n  options: LanguageFilterConfig,\n): [string[], (ids: string[]) => void] {\n  return useState(() => [...(options.defaultLanguages ?? []), ...getPersistedLanguageIds(options)])\n}\n", "import {createContext, useContext, useEffect, useMemo, useState} from 'react'\nimport {type LayoutProps, useClient} from 'sanity'\n\nimport {defaultFilterField} from './filterField'\nimport type {\n  Language,\n  LanguageCallback,\n  LanguageFilterConfig,\n  LanguageFilterConfigProcessed,\n} from './types'\nimport {useSelectedLanguageIds} from './useSelectedLanguageIds'\n\nexport interface LanguageFilterStudioContextProps {\n  // eslint-disable-next-line react/require-default-props\n  options: Required<LanguageFilterConfig>\n}\n\nexport interface LanguageFilterStudioContextProcessed {\n  options: Required<LanguageFilterConfigProcessed>\n}\n\nexport interface LanguageFilterStudioContextValue extends LanguageFilterStudioContextProcessed {\n  selectedLanguageIds: string[]\n  setSelectedLanguageIds: (ids: string[]) => void\n}\n\nexport const defaultContextValue: LanguageFilterStudioContextValue = {\n  options: {\n    apiVersion: '2022-11-27',\n    supportedLanguages: [],\n    defaultLanguages: [],\n    documentTypes: [],\n    filterField: defaultFilterField,\n  },\n  selectedLanguageIds: [],\n  setSelectedLanguageIds: () => console.error('LanguageFilterStudioContext not initialized'),\n}\n\nconst LanguageFilterStudioContext =\n  createContext<LanguageFilterStudioContextValue>(defaultContextValue)\n\n/**\n * This is a separate Provider from the Context that wraps the document pane\n * but it used to listen to changes to the selected language IDs inside it\n * and provide them to a Studio-wide context\n */\nexport function LanguageFilterStudioProvider(\n  props: LayoutProps & LanguageFilterStudioContextProps,\n) {\n  const client = useClient({apiVersion: '2023-01-01'})\n  const [languages, setLanguages] = useState<Language[]>(\n    Array.isArray(props.options.supportedLanguages) ? props.options.supportedLanguages : [],\n  )\n  useEffect(() => {\n    let asyncLanguages: Language[] = []\n\n    async function getLanguages(supportedLanguagesCallback: LanguageCallback) {\n      asyncLanguages = await supportedLanguagesCallback(client, {})\n      setLanguages(asyncLanguages)\n    }\n\n    if (!Array.isArray(props.options.supportedLanguages)) {\n      getLanguages(props.options.supportedLanguages)\n    }\n  }, [client, props.options.supportedLanguages])\n\n  const options = useMemo<Required<LanguageFilterConfigProcessed>>(() => {\n    return {\n      ...defaultContextValue.options,\n      ...props.options,\n      supportedLanguages: languages,\n    }\n  }, [props.options, languages])\n\n  const [selectedLanguageIds, setSelectedLanguageIds] = useSelectedLanguageIds(options)\n\n  return (\n    <LanguageFilterStudioContext.Provider\n      value={{options, selectedLanguageIds, setSelectedLanguageIds}}\n    >\n      {props.renderDefault(props)}\n    </LanguageFilterStudioContext.Provider>\n  )\n}\n\n/**\n * Retrieves plugin options and the currently selected\n * language IDs from anywhere in the Studio\n */\nexport function useLanguageFilterStudioContext() {\n  return useContext(LanguageFilterStudioContext)\n}\n", "import {useCallback, useMemo} from 'react'\n\nimport {useLanguageFilterStudioContext} from './LanguageFilterStudioContext'\nimport {getSelectableLanguages, persistLanguageIds} from './useSelectedLanguageIds'\n\nconst unique = (arr: string[]) => Array.from(new Set(arr))\n\nexport function usePaneLanguages(): {\n  activeLanguages: string[]\n  allSelected: boolean\n  selectAll: () => void\n  selectNone: () => void\n  toggleLanguage: (languageId: string) => void\n} {\n  const {selectedLanguageIds, setSelectedLanguageIds, options} = useLanguageFilterStudioContext()\n  const {defaultLanguages = []} = options\n\n  const selectableLanguages = useMemo(() => getSelectableLanguages(options), [options])\n\n  const updateSelectedIds = useCallback(\n    (ids: string[]) => {\n      setSelectedLanguageIds(unique([...defaultLanguages, ...ids]))\n      persistLanguageIds(unique([...defaultLanguages, ...ids]))\n    },\n    [defaultLanguages, setSelectedLanguageIds],\n  )\n\n  const selectAll = useCallback(\n    () => updateSelectedIds(selectableLanguages.map((l) => l.id)),\n    [updateSelectedIds, selectableLanguages],\n  )\n\n  const selectNone = useCallback(() => {\n    updateSelectedIds(defaultLanguages)\n  }, [defaultLanguages, updateSelectedIds])\n\n  const toggleLanguage = useCallback(\n    (languageId: string) => {\n      let lang = selectedLanguageIds\n\n      if (lang.includes(languageId)) {\n        lang = lang.filter((l) => l !== languageId)\n      } else {\n        lang = unique([...lang, languageId])\n      }\n\n      updateSelectedIds(lang)\n    },\n    [updateSelectedIds, selectedLanguageIds],\n  )\n\n  const activeLanguages = useMemo(\n    () => unique([...(defaultLanguages ?? []), ...selectedLanguageIds]),\n    [defaultLanguages, selectedLanguageIds],\n  )\n\n  return {\n    activeLanguages,\n    allSelected:\n      selectedLanguageIds.length === selectableLanguages.length + defaultLanguages.length,\n    selectAll,\n    selectNone,\n    toggleLanguage,\n  }\n}\n", "import {\n  CheckmarkCircleIcon,\n  CircleIcon,\n  EyeClosedIcon,\n  EyeOpenIcon,\n  TranslateIcon,\n} from '@sanity/icons'\nimport {\n  Badge,\n  Box,\n  Button,\n  Card,\n  Flex,\n  Popover,\n  Stack,\n  Text,\n  TextInput,\n  useClickOutside,\n} from '@sanity/ui'\nimport {type FormEvent, type MouseEventHandler, useCallback, useState} from 'react'\nimport {TextWithTone} from 'sanity'\nimport {styled} from 'styled-components'\n\nimport {useLanguageFilterStudioContext} from './LanguageFilterStudioContext'\nimport {usePaneLanguages} from './usePaneLanguages'\n\nconst StyledBox = styled(Box)`\n  max-height: calc(100vh - 200px);\n`\n\nexport function LanguageFilterMenuButton() {\n  const {options} = useLanguageFilterStudioContext()\n\n  const defaultLanguages = options.supportedLanguages.filter((l) =>\n    options.defaultLanguages?.includes(l.id),\n  )\n\n  const languageOptions = options.supportedLanguages.filter(\n    (l) => !options.defaultLanguages?.includes(l.id),\n  )\n  const [open, setOpen] = useState(false)\n  const {activeLanguages, allSelected, selectAll, selectNone, toggleLanguage} = usePaneLanguages()\n  const [button, setButton] = useState<HTMLElement | null>(null)\n  const [popover, setPopover] = useState<HTMLElement | null>(null)\n\n  const handleToggleAll: MouseEventHandler<HTMLButtonElement> = useCallback(\n    (event) => {\n      const checked = event.currentTarget.value === 'ALL'\n\n      if (checked) {\n        selectAll()\n      } else {\n        selectNone()\n      }\n    },\n    [selectAll, selectNone],\n  )\n\n  const handleClick = useCallback(() => setOpen((o) => !o), [])\n\n  const handleClickOutside = useCallback(() => setOpen(false), [])\n\n  useClickOutside(handleClickOutside, [button, popover])\n\n  const langCount = options.supportedLanguages.length\n\n  // Search filter query\n  const [query, setQuery] = useState('')\n  const handleQuery = useCallback((event: FormEvent<HTMLInputElement>) => {\n    if (event.currentTarget.value) {\n      setQuery(event.currentTarget.value)\n    } else {\n      setQuery('')\n    }\n  }, [])\n\n  const showSearch = langCount > 4\n\n  const content = (\n    <StyledBox overflow=\"auto\">\n      <Stack padding={1} space={1}>\n        {defaultLanguages.length > 0 && (\n          <>\n            {defaultLanguages.map((l) => (\n              <LanguageFilterOption key={l.id} id={l.id} title={l.title} selected />\n            ))}\n            <Card borderTop />\n          </>\n        )}\n\n        <Button\n          mode=\"bleed\"\n          onClick={handleToggleAll}\n          justify=\"flex-start\"\n          value={allSelected ? 'NONE' : 'ALL'}\n          disabled={!!query}\n        >\n          <Flex gap={3} align=\"center\">\n            <Text size={2}>\n              {allSelected ? (\n                <TextWithTone tone=\"primary\">\n                  <EyeClosedIcon />\n                </TextWithTone>\n              ) : (\n                <EyeOpenIcon />\n              )}\n            </Text>\n            <Box flex={1}>\n              <Text>{allSelected ? 'Hide all' : 'Show all'}</Text>\n            </Box>\n          </Flex>\n        </Button>\n\n        {showSearch ? (\n          <TextInput onChange={handleQuery} value={query} placeholder=\"Filter languages\" />\n        ) : (\n          <Card borderTop />\n        )}\n\n        {languageOptions\n          .filter((language) => {\n            if (query) {\n              return language.title.toLowerCase().includes(query.toLowerCase())\n            }\n            return true\n          })\n          .map((lang) => (\n            <LanguageFilterOption\n              id={lang.id}\n              key={lang.id}\n              onToggle={toggleLanguage}\n              selected={activeLanguages.includes(lang.id)}\n              title={lang.title}\n            />\n          ))}\n      </Stack>\n    </StyledBox>\n  )\n\n  const buttonText =\n    activeLanguages.length === langCount\n      ? 'Showing all'\n      : `Showing ${activeLanguages.length} / ${langCount}`\n  return (\n    <Popover animate content={content} open={open} portal ref={setPopover}>\n      <Button\n        text={buttonText}\n        icon={TranslateIcon}\n        mode=\"bleed\"\n        onClick={handleClick}\n        ref={setButton}\n        selected={open}\n      />\n    </Popover>\n  )\n}\n\nfunction LanguageFilterOption(props: {\n  id: string\n  selected: boolean\n  title: string\n  // eslint-disable-next-line react/require-default-props\n  onToggle?: (id: string) => void\n}) {\n  const {id, onToggle, selected, title} = props\n\n  const handleChange = useCallback(() => {\n    if (onToggle) {\n      onToggle(id)\n    }\n  }, [id, onToggle])\n\n  const disabled = !onToggle\n\n  return (\n    <Button mode=\"bleed\" onClick={handleChange} justify=\"flex-start\" disabled={disabled}>\n      <Flex gap={3} align=\"center\">\n        <Text size={2}>\n          {selected ? (\n            <TextWithTone tone={disabled ? 'default' : 'positive'}>\n              <CheckmarkCircleIcon />\n            </TextWithTone>\n          ) : (\n            <CircleIcon />\n          )}\n        </Text>\n        <Box flex={1}>\n          <Text>{title}</Text>\n        </Box>\n        <Badge>{id}</Badge>\n      </Flex>\n    </Button>\n  )\n}\n", "import {useMemo} from 'react'\nimport {type ObjectInputProps, type ObjectMember, useFormValue, useSchema} from 'sanity'\n\nimport {isLanguageFilterEnabled} from './filterField'\nimport {useLanguageFilterStudioContext} from './LanguageFilterStudioContext'\n\n// First check that this Object is in a schema type for which language-filter is enabled\nexport function FilteredObjectWrapper(props: ObjectInputProps) {\n  const {options} = useLanguageFilterStudioContext()\n\n  const documentType = useFormValue(['_type']) as string\n  const schema = useSchema()\n  const languageFilterEnabled = isLanguageFilterEnabled(schema.get(documentType), options)\n  return languageFilterEnabled ? <FilteredObjectInput {...props} /> : props.renderDefault(props)\n}\n\n// Modify the object members based on selected languages in the filter\nexport function FilteredObjectInput(props: ObjectInputProps) {\n  const {members: membersProp, schemaType, renderDefault, ...restProps} = props\n  const {selectedLanguageIds, options} = useLanguageFilterStudioContext()\n  const {filterField} = options\n\n  const members: ObjectMember[] = useMemo(() => {\n    return membersProp\n      .filter((member) => {\n        return (\n          (member.kind === 'field' && filterField(schemaType, member, selectedLanguageIds)) ||\n          member.kind === 'fieldSet' ||\n          member.kind === 'error'\n        )\n      })\n      .map((member) => {\n        if (member.kind === 'fieldSet') {\n          return {\n            ...member,\n            fieldSet: {\n              ...member.fieldSet,\n              members: member.fieldSet.members.filter((fieldsetMember) => {\n                return (\n                  fieldsetMember.kind === 'field' &&\n                  filterField(schemaType, fieldsetMember, selectedLanguageIds)\n                )\n              }),\n            },\n          }\n        }\n        return member\n      })\n  }, [schemaType, membersProp, filterField, selectedLanguageIds])\n\n  return renderDefault({...restProps, members, schemaType, renderDefault})\n}\n", "import {\n  definePlugin,\n  type DocumentLanguageFilterComponent,\n  isObjectSchemaType,\n  type ObjectInputProps,\n} from 'sanity'\n\nimport {isLanguageFilterEnabled} from './filterField'\nimport {LanguageFilterMenuButton} from './LanguageFilterMenuButton'\nimport {FilteredObjectWrapper} from './LanguageFilterObjectInput'\nimport {defaultContextValue, LanguageFilterStudioProvider} from './LanguageFilterStudioContext'\nimport type {LanguageFilterConfig} from './types'\n\n/**\n * ## Usage in sanity.config.ts (or .js)\n *\n * ```\n * import {defineConfig} from 'sanity'\n * import {languageFilter} from '@sanity/language-filter'\n *\n * export const defineConfig({\n *     /...\n *     plugins: [\n *         languageFilter({\n *             supportedLanguages: [\n *               {id: 'nb', title: 'Norwegian (Bokmål)'},\n *               {id: 'nn', title: 'Norwegian (Nynorsk)'},\n *               {id: 'en', title: 'English'},\n *               {id: 'es', title: 'Spanish'},\n *               {id: 'arb', title: 'Arabic'},\n *               {id: 'pt', title: 'Portuguese'},\n *               //...\n *             ],\n *             // Select Norwegian (Bokmål) by default\n *             defaultLanguages: ['nb'],\n *             // Only show language filter for document type `page` (schemaType.name)\n *             // Can also enable via document-options: options.languageFilter: true\n *             documentTypes: ['page'],\n *             // default filter function shown\n *             filterField: (enclosingType, field, selectedLanguageIds) =>\n *               !enclosingType.name.startsWith('locale') || selectedLanguageIds.includes(field.name),\n *        })\n *    ]\n * })\n * ```\n */\nexport const languageFilter = definePlugin<LanguageFilterConfig>((options) => {\n  const RenderLanguageFilter: DocumentLanguageFilterComponent = () => {\n    return <LanguageFilterMenuButton />\n  }\n\n  const pluginOptions = {\n    ...defaultContextValue.options,\n    ...options,\n  }\n\n  return {\n    name: '@sanity/language-filter',\n    studio: {\n      components: {\n        layout: (props) => LanguageFilterStudioProvider({...props, options: pluginOptions}),\n      },\n    },\n\n    document: {\n      unstable_languageFilter: (prev, {schemaType, schema}) => {\n        if (isLanguageFilterEnabled(schema.get(schemaType), options)) {\n          return [...prev, RenderLanguageFilter]\n        }\n        return prev\n      },\n    },\n\n    form: {\n      components: {\n        input: (props) => {\n          if (props.id !== 'root' && isObjectSchemaType(props.schemaType)) {\n            return FilteredObjectWrapper(props as ObjectInputProps)\n          }\n\n          return props.renderDefault(props)\n        },\n      },\n    },\n  }\n})\n", "/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n\nimport * as suspend from 'suspend-react'\n\nimport type {Language} from './types'\n\nexport const namespace = 'sanity-plugin-internationalized-array'\n\nexport const version = 'v1'\n\n// https://github.com/pmndrs/suspend-react#preloading\nexport const preload = (fn: () => Promise<Language[]>) =>\n  suspend.preload(() => fn(), [version, namespace])\n\n// https://github.com/pmndrs/suspend-react#cache-busting\nexport const clear = () => suspend.clear([version, namespace])\n\n// https://github.com/pmndrs/suspend-react#peeking-into-entries-outside-of-suspense\nexport const peek = (selectedValue: Record<string, unknown>) =>\n  suspend.peek([version, namespace, selectedValue]) as Language[] | undefined\n", "import {PluginConfig} from './types'\n\nexport const MAX_COLUMNS = {\n  codeOnly: 5,\n  titleOnly: 4,\n  titleAndCode: 3,\n}\n\nexport const CONFIG_DEFAULT: Required<PluginConfig> = {\n  languages: [],\n  select: {},\n  defaultLanguages: [],\n  fieldTypes: [],\n  apiVersion: '2022-11-27',\n  buttonLocations: ['field'],\n  buttonAddAll: true,\n  languageDisplay: 'codeOnly',\n}\n", "import {SanityDocument} from 'sanity'\n\nexport interface DocumentsToTranslate {\n  path: (string | number)[]\n  pathString: string\n  _key: string\n  _type: string\n  [key: string]: unknown\n}\n\nexport const getDocumentsToTranslate = (\n  value: SanityDocument | unknown,\n  rootPath: (string | number)[] = []\n): DocumentsToTranslate[] => {\n  if (Array.isArray(value)) {\n    const arrayRootPath = [...rootPath]\n\n    // if item contains internationalized return array\n    const internationalizedValues = value.filter((item) => {\n      if (Array.isArray(item)) return false\n\n      if (typeof item === 'object') {\n        const type = item?._type as string | undefined\n        return (\n          type?.startsWith('internationalizedArray') && type?.endsWith('Value')\n        )\n      }\n      return false\n    })\n\n    if (internationalizedValues.length > 0) {\n      return internationalizedValues.map((internationalizedValue) => {\n        return {\n          ...internationalizedValue,\n          path: arrayRootPath,\n          pathString: arrayRootPath.join('.'),\n        }\n      })\n    }\n\n    if (value.length > 0) {\n      return value\n        .map((item, index) =>\n          getDocumentsToTranslate(item, [...arrayRootPath, index])\n        )\n        .flat()\n    }\n\n    return []\n  }\n  if (typeof value === 'object' && value) {\n    const startsWithUnderscoreRegex = /^_/\n    const itemKeys = Object.keys(value).filter(\n      (key) => !key.match(startsWithUnderscoreRegex)\n    ) as (keyof typeof value)[]\n\n    return itemKeys\n      .map((item) => {\n        const selectedValue = value[item] as unknown\n        const path = [...rootPath, item]\n        return getDocumentsToTranslate(selectedValue, path)\n      })\n      .flat()\n  }\n  return []\n}\n", "import {LanguageDisplay} from '../types'\n\nexport function getLanguageDisplay(\n  languageDisplay: LanguageDisplay,\n  title: string,\n  code: string\n): string {\n  if (languageDisplay === 'codeOnly') return code.toUpperCase()\n  if (languageDisplay === 'titleOnly') return title\n  if (languageDisplay === 'titleAndCode')\n    return `${title} (${code.toUpperCase()})`\n  return title\n}\n", "import {AddIcon} from '@sanity/icons'\nimport {Button, Grid} from '@sanity/ui'\nimport type React from 'react'\nimport {memo} from 'react'\n\nimport {MAX_COLUMNS} from '../constants'\nimport type {Language, Value} from '../types'\nimport {getLanguageDisplay} from '../utils/getLanguageDisplay'\nimport {useInternationalizedArrayContext} from './InternationalizedArrayContext'\n\ntype AddButtonsProps = {\n  languages: Language[]\n  readOnly: boolean\n  value: Value[] | undefined\n  onClick: (event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void\n}\n\nfunction AddButtons(props: AddButtonsProps) {\n  const {languages, readOnly, value, onClick} = props\n  const {languageDisplay} = useInternationalizedArrayContext()\n\n  return languages.length > 0 ? (\n    <Grid\n      columns={Math.min(languages.length, MAX_COLUMNS[languageDisplay])}\n      gap={2}\n    >\n      {languages.map((language) => {\n        const languageTitle: string = getLanguageDisplay(\n          languageDisplay,\n          language.title,\n          language.id\n        )\n        return (\n          <Button\n            key={language.id}\n            tone=\"primary\"\n            mode=\"ghost\"\n            fontSize={1}\n            disabled={\n              readOnly ||\n              Boolean(value?.find((item) => item._key === language.id))\n            }\n            text={languageTitle}\n            // Only show plus icon if there's one row or less AND only showing codes\n            icon={\n              languages.length > MAX_COLUMNS[languageDisplay] &&\n              languageDisplay === 'codeOnly'\n                ? undefined\n                : AddIcon\n            }\n            value={language.id}\n            onClick={onClick}\n          />\n        )\n      })}\n    </Grid>\n  ) : null\n}\n\nexport default memo(AddButtons)\n", "import {Box, Stack, Text, useToast} from '@sanity/ui'\nimport React, {useCallback} from 'react'\nimport {\n  FormInsertPatch,\n  FormSetIfMissingPatch,\n  insert,\n  isSanityDocument,\n  PatchEvent,\n  setIfMissing,\n} from 'sanity'\nimport {useDocumentPane} from 'sanity/structure'\n\nimport {\n  DocumentsToTranslate,\n  getDocumentsToTranslate,\n} from '../utils/getDocumentsToTranslate'\nimport AddButtons from './AddButtons'\nimport {useInternationalizedArrayContext} from './InternationalizedArrayContext'\n\ntype DocumentAddButtonsProps = {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  value: Record<string, any> | undefined\n}\nexport default function DocumentAddButtons(props: DocumentAddButtonsProps) {\n  const {filteredLanguages} = useInternationalizedArrayContext()\n  const value = isSanityDocument(props.value) ? props.value : undefined\n\n  const toast = useToast()\n  const {onChange} = useDocumentPane()\n\n  const documentsToTranslation = getDocumentsToTranslate(value, [])\n\n  const handleDocumentButtonClick = useCallback(\n    async (event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n      const languageId = event.currentTarget.value\n      if (!languageId) {\n        toast.push({\n          status: 'error',\n          title: 'No language selected',\n        })\n        return\n      }\n      const alreadyTranslated = documentsToTranslation.filter(\n        (translation) => translation?._key === languageId\n      )\n      const removeDuplicates = documentsToTranslation.reduce<\n        DocumentsToTranslate[]\n      >((filteredTranslations, translation) => {\n        if (\n          alreadyTranslated.filter(\n            (alreadyTranslation) =>\n              alreadyTranslation.pathString === translation.pathString\n          ).length > 0\n        ) {\n          return filteredTranslations\n        }\n        const translationAlreadyExists = filteredTranslations.filter(\n          (filteredTranslation) => filteredTranslation.path === translation.path\n        )\n\n        if (translationAlreadyExists.length > 0) {\n          return filteredTranslations\n        }\n        return [...filteredTranslations, translation]\n      }, [])\n      if (removeDuplicates.length === 0) {\n        toast.push({\n          status: 'error',\n          title: 'No internationalizedArray fields found in document root',\n        })\n        return\n      }\n\n      // Write a new patch for each empty field\n      const patches: (FormSetIfMissingPatch | FormInsertPatch)[] = []\n\n      for (const toTranslate of removeDuplicates) {\n        const path = toTranslate.path\n\n        const ifMissing = setIfMissing([], path)\n        const insertValue = insert(\n          [\n            {\n              _key: languageId,\n              _type: toTranslate._type,\n              value: undefined,\n            },\n          ],\n          'after',\n          [...path, -1]\n        )\n        patches.push(ifMissing)\n        patches.push(insertValue)\n      }\n\n      onChange(PatchEvent.from(patches.flat()))\n    },\n    [documentsToTranslation, onChange, toast]\n  )\n  return (\n    <Stack space={3}>\n      <Box>\n        <Text size={1} weight=\"semibold\">\n          Add translation to internationalized fields\n        </Text>\n      </Box>\n      <AddButtons\n        languages={filteredLanguages}\n        readOnly={false}\n        value={undefined}\n        onClick={handleDocumentButtonClick}\n      />\n    </Stack>\n  )\n}\n", "import {get} from 'lodash'\n\nexport const getSelectedValue = (\n  select: Record<string, string> | undefined,\n  document:\n    | {\n        [x: string]: unknown\n      }\n    | undefined\n): Record<string, unknown> => {\n  if (!select || !document) {\n    return {}\n  }\n\n  const selection: Record<string, string> = select || {}\n  const selectedValue: Record<string, unknown> = {}\n  for (const [key, path] of Object.entries(selection)) {\n    let value = get(document, path)\n    if (Array.isArray(value)) {\n      // If there are references in the array, ensure they have `_ref` set, otherwise they are considered empty and can safely be ignored\n      value = value.filter((item) =>\n        typeof item === 'object'\n          ? item?._type === 'reference' && '_ref' in item\n          : true\n      )\n    }\n    selectedValue[key] = value\n  }\n\n  return selectedValue\n}\n", "import {useLanguageFilterStudioContext} from '@sanity/language-filter'\nimport {Stack} from '@sanity/ui'\nimport equal from 'fast-deep-equal'\nimport {createContext, useContext, useDeferredValue, useMemo} from 'react'\nimport {type ObjectInputProps, useClient, useWorkspace} from 'sanity'\nimport {useDocumentPane} from 'sanity/structure'\nimport {suspend} from 'suspend-react'\n\nimport {namespace, version} from '../cache'\nimport {CONFIG_DEFAULT} from '../constants'\nimport type {Language, PluginConfig} from '../types'\nimport DocumentAddButtons from './DocumentAddButtons'\nimport {getSelectedValue} from './getSelectedValue'\n\n// This provider makes the plugin config available to all components in the document form\n// But with languages resolved and filtered languages updated base on @sanity/language-filter\n\ntype InternationalizedArrayContextProps = Required<PluginConfig> & {\n  languages: Language[]\n  filteredLanguages: Language[]\n}\n\nexport const InternationalizedArrayContext =\n  createContext<InternationalizedArrayContextProps>({\n    ...CONFIG_DEFAULT,\n    languages: [],\n    filteredLanguages: [],\n  })\n\nexport function useInternationalizedArrayContext() {\n  return useContext(InternationalizedArrayContext)\n}\n\ntype InternationalizedArrayProviderProps = ObjectInputProps & {\n  internationalizedArray: Required<PluginConfig>\n}\n\nexport function InternationalizedArrayProvider(\n  props: InternationalizedArrayProviderProps\n) {\n  const {internationalizedArray} = props\n\n  const client = useClient({apiVersion: internationalizedArray.apiVersion})\n  const workspace = useWorkspace()\n  const {formState} = useDocumentPane()\n  const deferredDocument = useDeferredValue(formState?.value)\n  const selectedValue = useMemo(\n    () => getSelectedValue(internationalizedArray.select, deferredDocument),\n    [internationalizedArray.select, deferredDocument]\n  )\n\n  // Fetch or return languages\n  const languages = Array.isArray(internationalizedArray.languages)\n    ? internationalizedArray.languages\n    : suspend(\n        // eslint-disable-next-line require-await\n        async () => {\n          if (typeof internationalizedArray.languages === 'function') {\n            return internationalizedArray.languages(client, selectedValue)\n          }\n          return internationalizedArray.languages\n        },\n        [version, namespace, selectedValue, workspace],\n        {equal}\n      )\n\n  // Filter out some languages if language filter is enabled\n  const {selectedLanguageIds, options: languageFilterOptions} =\n    useLanguageFilterStudioContext()\n\n  const filteredLanguages = useMemo(() => {\n    const documentType = deferredDocument ? deferredDocument._type : undefined\n    const languageFilterEnabled =\n      typeof documentType === 'string' &&\n      languageFilterOptions.documentTypes.includes(documentType)\n\n    return languageFilterEnabled\n      ? languages.filter((language) =>\n          selectedLanguageIds.includes(language.id)\n        )\n      : languages\n  }, [deferredDocument, languageFilterOptions, languages, selectedLanguageIds])\n\n  const showDocumentButtons =\n    internationalizedArray.buttonLocations.includes('document')\n  const context = useMemo(\n    () => ({...internationalizedArray, languages, filteredLanguages}),\n    [filteredLanguages, internationalizedArray, languages]\n  )\n\n  return (\n    <InternationalizedArrayContext.Provider value={context}>\n      {showDocumentButtons ? (\n        <Stack space={5}>\n          <DocumentAddButtons value={props.value} />\n          {props.renderDefault(props)}\n        </Stack>\n      ) : (\n        props.renderDefault(props)\n      )}\n    </InternationalizedArrayContext.Provider>\n  )\n}\n", "import type {ReactNode} from 'react'\nimport {useMemo} from 'react'\nimport {type FieldProps} from 'sanity'\n\nimport {useInternationalizedArrayContext} from './InternationalizedArrayContext'\n\nexport default function InternationalizedField(props: FieldProps): ReactNode {\n  const {languages} = useInternationalizedArrayContext()\n\n  // hide titles for 'value' fields within valid language entries\n  const customProps = useMemo(() => {\n    const pathSegment = props.path.slice(0, -1)[1]\n    const languageId =\n      typeof pathSegment === 'object' && '_key' in pathSegment\n        ? pathSegment._key\n        : undefined\n    const hasValidLanguageId = languageId\n      ? languages.some((l) => l.id === languageId)\n      : false\n    const shouldHideTitle =\n      props.title?.toLowerCase() === 'value' && hasValidLanguageId\n\n    return {\n      ...props,\n      title: shouldHideTitle ? '' : props.title,\n    }\n  }, [props, languages])\n\n  if (!customProps.schemaType.name.startsWith('internationalizedArray')) {\n    return customProps.renderDefault(customProps)\n  }\n\n  // Show reference field selector if there's a value\n  if (customProps.schemaType.name === 'reference' && customProps.value) {\n    return customProps.renderDefault({\n      ...customProps,\n      title: '',\n      level: 0, // Reset the level to avoid nested styling\n    })\n  }\n\n  // For basic field types, we can use children to keep the simple input\n  if (\n    customProps.schemaType.name === 'string' ||\n    customProps.schemaType.name === 'number' ||\n    customProps.schemaType.name === 'text'\n  ) {\n    return customProps.children\n  }\n\n  // For complex fields (like markdown), we need to use renderDefault\n  // to get all the field's functionality\n  return customProps.renderDefault({\n    ...customProps,\n    level: 0, // Reset the level to avoid nested styling\n  })\n}\n", "import {memo} from 'react'\nimport {useClient} from 'sanity'\n\nimport {peek, preload} from '../cache'\nimport type {PluginConfig} from '../types'\n\nexport default memo(function Preload(\n  props: Required<Pick<PluginConfig, 'apiVersion' | 'languages'>>\n) {\n  const client = useClient({apiVersion: props.apiVersion})\n  if (!Array.isArray(peek({}))) {\n    // eslint-disable-next-line require-await\n    preload(async () =>\n      Array.isArray(props.languages)\n        ? props.languages\n        : props.languages(client, {})\n    )\n  }\n\n  return null\n})\n", "import {Language, Value} from '../types'\n\nexport function checkAllLanguagesArePresent(\n  languages: Language[],\n  value: Value[] | undefined\n): boolean {\n  const filteredLanguageIds = languages.map((l) => l.id)\n  const languagesInUseIds = value ? value.map((v) => v._key) : []\n\n  return (\n    languagesInUseIds.length === filteredLanguageIds.length &&\n    languagesInUseIds.every((l) => filteredLanguageIds.includes(l))\n  )\n}\n", "import {Language, Value} from '../types'\n\nexport function createAddAllTitle(\n  value: Value[] | undefined,\n  languages: Language[]\n): string {\n  if (value?.length) {\n    return `Add missing ${\n      languages.length - value.length === 1 ? `language` : `languages`\n    }`\n  }\n\n  return languages.length === 1\n    ? `Add ${languages[0].title} Field`\n    : `Add all languages`\n}\n", "import {SchemaType} from 'sanity'\n\nexport function createValueSchemaTypeName(schemaType: SchemaType): string {\n  return `${schemaType.name}Value`\n}\n", "import {FormInsertPatch, insert, Path, SchemaType} from 'sanity'\n\nimport {Language, Value} from '../types'\nimport {createValueSchemaTypeName} from './createValueSchemaTypeName'\n\ntype AddConfig = {\n  // New keys to add to the field\n  addLanguageKeys: string[]\n  // Schema of the current field\n  schemaType: SchemaType\n  // All languages registered in the plugin\n  languages: Language[]\n  // Languages that are currently visible\n  filteredLanguages: Language[]\n  // Current value of the internationalizedArray field\n  value?: Value[]\n  // Path to this item\n  path?: Path\n}\n\nexport function createAddLanguagePatches(config: AddConfig): FormInsertPatch[] {\n  const {\n    addLanguageKeys,\n    schemaType,\n    languages,\n    filteredLanguages,\n    value,\n    path = [],\n  } = config\n\n  const itemBase = {_type: createValueSchemaTypeName(schemaType)}\n\n  // Create new items\n  const getNewItems = () => {\n    if (Array.isArray(addLanguageKeys) && addLanguageKeys.length > 0) {\n      return addLanguageKeys.map((id) => ({\n        ...itemBase,\n        _key: id,\n      }))\n    }\n\n    return filteredLanguages\n      .filter((language) =>\n        value?.length ? !value.find((v) => v._key === language.id) : true\n      )\n      .map((language) => ({\n        ...itemBase,\n        _key: language.id,\n      }))\n  }\n  const newItems = getNewItems()\n\n  // Insert new items in the correct order\n  const languagesInUse = value?.length ? value.map((v) => v) : []\n\n  const insertions = newItems.map((item) => {\n    // What's the original index of this language?\n    const languageIndex = languages.findIndex((l) => item._key === l.id)\n\n    // What languages are there beyond that index?\n    const remainingLanguages = languages.slice(languageIndex + 1)\n\n    // So what is the index in the current value array of the next language in the language array?\n    const nextLanguageIndex = languagesInUse.findIndex((l) =>\n      // eslint-disable-next-line max-nested-callbacks\n      remainingLanguages.find((r) => r.id === l._key)\n    )\n\n    // Keep local state up to date incase multiple insertions are being made\n    if (nextLanguageIndex < 0) {\n      languagesInUse.push(item)\n    } else {\n      languagesInUse.splice(nextLanguageIndex, 0, item)\n    }\n\n    return nextLanguageIndex < 0\n      ? // No next language (-1), add to end of array\n        insert([item], 'after', [...path, nextLanguageIndex])\n      : // Next language found, insert before that\n        insert([item], 'before', [...path, nextLanguageIndex])\n  })\n\n  return insertions\n}\n", "import {AddIcon, TranslateIcon} from '@sanity/icons'\nimport {useCallback} from 'react'\nimport {\n  defineDocumentFieldAction,\n  type DocumentFieldActionItem,\n  type DocumentFieldActionProps,\n  PatchEvent,\n  setIfMissing,\n  useFormValue,\n} from 'sanity'\nimport {useDocumentPane} from 'sanity/structure'\n\nimport {useInternationalizedArrayContext} from '../components/InternationalizedArrayContext'\nimport type {Language, Value} from '../types'\nimport {checkAllLanguagesArePresent} from '../utils/checkAllLanguagesArePresent'\nimport {createAddAllTitle} from '../utils/createAddAllTitle'\nimport {createAddLanguagePatches} from '../utils/createAddLanguagePatches'\n\nconst createTranslateFieldActions: (\n  fieldActionProps: DocumentFieldActionProps,\n  context: {\n    languages: Language[]\n    filteredLanguages: Language[]\n  }\n) => DocumentFieldActionItem[] = (\n  fieldActionProps,\n  {languages, filteredLanguages}\n) =>\n  languages.map((language) => {\n    const value = useFormValue(fieldActionProps.path) as Value[]\n    const disabled =\n      value && Array.isArray(value)\n        ? Boolean(value?.find((item) => item._key === language.id))\n        : false\n    const hidden = !filteredLanguages.some((f) => f.id === language.id)\n\n    const {onChange} = useDocumentPane()\n\n    const onAction = useCallback(() => {\n      const {schemaType, path} = fieldActionProps\n\n      const addLanguageKeys = [language.id]\n      const patches = createAddLanguagePatches({\n        addLanguageKeys,\n        schemaType,\n        languages,\n        filteredLanguages,\n        value,\n        path,\n      })\n\n      onChange(PatchEvent.from([setIfMissing([], path), ...patches]))\n    }, [language.id, value, onChange])\n\n    return {\n      type: 'action',\n      icon: AddIcon,\n      onAction,\n      title: language.title,\n      hidden,\n      disabled,\n    }\n  })\n\nconst AddMissingTranslationsFieldAction: (\n  fieldActionProps: DocumentFieldActionProps,\n  context: {\n    languages: Language[]\n    filteredLanguages: Language[]\n  }\n) => DocumentFieldActionItem = (\n  fieldActionProps,\n  {languages, filteredLanguages}\n) => {\n  const value = useFormValue(fieldActionProps.path) as Value[]\n  const disabled = value && value.length === filteredLanguages.length\n  const hidden = checkAllLanguagesArePresent(filteredLanguages, value)\n\n  const {onChange} = useDocumentPane()\n\n  const onAction = useCallback(() => {\n    const {schemaType, path} = fieldActionProps\n\n    const addLanguageKeys: string[] = []\n    const patches = createAddLanguagePatches({\n      addLanguageKeys,\n      schemaType,\n      languages,\n      filteredLanguages,\n      value,\n      path,\n    })\n\n    onChange(PatchEvent.from([setIfMissing([], path), ...patches]))\n  }, [fieldActionProps, filteredLanguages, languages, onChange, value])\n\n  return {\n    type: 'action',\n    icon: AddIcon,\n    onAction,\n    title: createAddAllTitle(value, filteredLanguages),\n    disabled,\n    hidden,\n  }\n}\n\nexport const internationalizedArrayFieldAction = defineDocumentFieldAction({\n  name: 'internationalizedArray',\n  useAction(fieldActionProps) {\n    const isInternationalizedArrayField =\n      fieldActionProps?.schemaType?.type?.name.startsWith(\n        'internationalizedArray'\n      )\n    const {languages, filteredLanguages} = useInternationalizedArrayContext()\n\n    const translateFieldActions = createTranslateFieldActions(\n      fieldActionProps,\n      {languages, filteredLanguages}\n    )\n\n    return {\n      type: 'group',\n      icon: TranslateIcon,\n      title: 'Add Translation',\n      renderAsButton: true,\n      children: isInternationalizedArrayField\n        ? [\n            ...translateFieldActions,\n            AddMissingTranslationsFieldAction(fieldActionProps, {\n              languages,\n              filteredLanguages,\n            }),\n          ]\n        : [],\n      hidden: !isInternationalizedArrayField,\n    }\n  },\n})\n", "export function camelCase(string: string): string {\n  return string.replace(/-([a-z])/g, (g) => g[1].toUpperCase())\n}\n\nexport function titleCase(string: string): string {\n  return string\n    .split(` `)\n    .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(` `)\n}\n\nexport function pascalCase(string: string): string {\n  return titleCase(camelCase(string))\n}\n\nexport function createFieldName(name: string, addValue = false): string {\n  return addValue\n    ? [`internationalizedArray`, pascalCase(name), `Value`].join(``)\n    : [`internationalizedArray`, pascalCase(name)].join(``)\n}\n", "import {Card, Code, Stack, Text} from '@sanity/ui'\n\nconst schemaExample = {\n  languages: [\n    {id: 'en', title: 'English'},\n    {id: 'no', title: 'Norsk'},\n  ],\n}\n\nexport default function Feedback() {\n  return (\n    <Card tone=\"caution\" border radius={2} padding={3}>\n      <Stack space={4}>\n        <Text>\n          An array of language objects must be passed into the{' '}\n          <code>internationalizedArray</code> helper function, each with an{' '}\n          <code>id</code> and <code>title</code> field. Example:\n        </Text>\n        <Card padding={2} border radius={2}>\n          <Code size={1} language=\"javascript\">\n            {JSON.stringify(schemaExample, null, 2)}\n          </Code>\n        </Card>\n      </Stack>\n    </Card>\n  )\n}\n", "import {AddIcon} from '@sanity/icons'\nimport {useLanguageFilterStudioContext} from '@sanity/language-filter'\nimport {Button, Card, Stack, Text, useToast} from '@sanity/ui'\nimport type React from 'react'\nimport {useCallback, useEffect, useMemo} from 'react'\nimport {\n  type ArrayOfObjectsInputProps,\n  ArrayOfObjectsItem,\n  type ArraySchemaType,\n  MemberItemError,\n  set,\n  setIfMissing,\n  useFormValue,\n} from 'sanity'\nimport {useDocumentPane} from 'sanity/structure'\n\nimport type {Value} from '../types'\nimport {checkAllLanguagesArePresent} from '../utils/checkAllLanguagesArePresent'\nimport {createAddAllTitle} from '../utils/createAddAllTitle'\nimport {createAddLanguagePatches} from '../utils/createAddLanguagePatches'\nimport AddButtons from './AddButtons'\nimport Feedback from './Feedback'\nimport {useInternationalizedArrayContext} from './InternationalizedArrayContext'\n\nexport type InternationalizedArrayProps = ArrayOfObjectsInputProps<\n  Value,\n  ArraySchemaType\n>\n\nexport default function InternationalizedArray(\n  props: InternationalizedArrayProps\n) {\n  const {members, value, schemaType, onChange} = props\n\n  const readOnly =\n    typeof schemaType.readOnly === 'boolean' ? schemaType.readOnly : false\n  const toast = useToast()\n\n  const {\n    languages,\n    filteredLanguages,\n    defaultLanguages,\n    buttonAddAll,\n    buttonLocations,\n  } = useInternationalizedArrayContext()\n\n  // Support updating the UI if languageFilter is installed\n  const {selectedLanguageIds, options: languageFilterOptions} =\n    useLanguageFilterStudioContext()\n  const documentType = useFormValue(['_type'])\n  const languageFilterEnabled =\n    typeof documentType === 'string' &&\n    languageFilterOptions.documentTypes.includes(documentType)\n\n  const filteredMembers = useMemo(\n    () =>\n      languageFilterEnabled\n        ? members.filter((member) => {\n            // This member is the outer object created by the plugin\n            // Satisfy TS\n            if (member.kind !== 'item') {\n              return false\n            }\n\n            // This is the inner \"value\" field member created by this plugin\n            const valueMember = member.item.members[0]\n\n            // Satisfy TS\n            if (valueMember.kind !== 'field') {\n              return false\n            }\n\n            return languageFilterOptions.filterField(\n              member.item.schemaType,\n              valueMember,\n              selectedLanguageIds\n            )\n          })\n        : members,\n    [languageFilterEnabled, members, languageFilterOptions, selectedLanguageIds]\n  )\n\n  const handleAddLanguage = useCallback(\n    async (\n      param?: React.MouseEvent<HTMLButtonElement, MouseEvent> | string[]\n    ) => {\n      if (!filteredLanguages?.length) {\n        return\n      }\n\n      const addLanguageKeys: string[] = Array.isArray(param)\n        ? param\n        : ([param?.currentTarget?.value].filter(Boolean) as string[])\n\n      const patches = createAddLanguagePatches({\n        addLanguageKeys,\n        schemaType,\n        languages,\n        filteredLanguages,\n        value,\n      })\n\n      onChange([setIfMissing([]), ...patches])\n    },\n    [filteredLanguages, languages, onChange, schemaType, value]\n  )\n\n  const {isDeleting} = useDocumentPane()\n\n  const addedLanguages = members.map(({key}) => key)\n  const hasAddedDefaultLanguages = defaultLanguages\n    .filter((language) => languages.find((l) => l.id === language))\n    .every((language) => addedLanguages.includes(language))\n\n  useEffect(() => {\n    if (!isDeleting && !hasAddedDefaultLanguages) {\n      const languagesToAdd = defaultLanguages\n        .filter((language) => !addedLanguages.includes(language))\n        .filter((language) => languages.find((l) => l.id === language))\n      // Account for strict mode by scheduling the update\n      const timeout = setTimeout(() => handleAddLanguage(languagesToAdd))\n      return () => clearTimeout(timeout)\n    }\n    return undefined\n  }, [\n    isDeleting,\n    hasAddedDefaultLanguages,\n    handleAddLanguage,\n    defaultLanguages,\n    addedLanguages,\n    languages,\n  ])\n\n  // TODO: This is reordering and re-setting the whole array, it could be surgical\n  const handleRestoreOrder = useCallback(() => {\n    if (!value?.length || !languages?.length) {\n      return\n    }\n\n    // Create a new value array in the correct order\n    // This would also strip out values that don't have a language as the key\n    const updatedValue = value\n      .reduce((acc, v) => {\n        const newIndex = languages.findIndex((l) => l.id === v?._key)\n\n        if (newIndex > -1) {\n          acc[newIndex] = v\n        }\n\n        return acc\n      }, [] as Value[])\n      .filter(Boolean)\n\n    if (value?.length !== updatedValue.length) {\n      toast.push({\n        title: 'There was an error reordering languages',\n        status: 'warning',\n      })\n    }\n\n    onChange(set(updatedValue))\n  }, [toast, languages, onChange, value])\n\n  const allKeysAreLanguages = useMemo(() => {\n    if (!value?.length || !languages?.length) {\n      return true\n    }\n\n    return value?.every((v) => languages.find((l) => l?.id === v?._key))\n  }, [value, languages])\n\n  // Check languages are in the correct order\n  const languagesInUse = useMemo(\n    () =>\n      languages && languages.length > 1\n        ? languages.filter((l) => value?.find((v) => v._key === l.id))\n        : [],\n    [languages, value]\n  )\n\n  const languagesOutOfOrder = useMemo(() => {\n    if (!value?.length || !languagesInUse.length) {\n      return []\n    }\n\n    return value\n      .map((v, vIndex) =>\n        vIndex === languagesInUse.findIndex((l) => l.id === v._key) ? null : v\n      )\n      .filter(Boolean)\n  }, [value, languagesInUse])\n\n  const languagesAreValid = useMemo(\n    () =>\n      !languages?.length ||\n      (languages?.length && languages.every((item) => item.id && item.title)),\n    [languages]\n  )\n\n  // Automatically restore order of fields\n  useEffect(() => {\n    if (languagesOutOfOrder.length > 0 && allKeysAreLanguages) {\n      handleRestoreOrder()\n    }\n  }, [languagesOutOfOrder, allKeysAreLanguages, handleRestoreOrder])\n\n  // compare value keys with possible languages\n  const allLanguagesArePresent = useMemo(\n    () => checkAllLanguagesArePresent(filteredLanguages, value),\n    [filteredLanguages, value]\n  )\n\n  if (!languagesAreValid) {\n    return <Feedback />\n  }\n\n  const addButtonsAreVisible =\n    // Plugin was configured to display buttons here (default!)\n    buttonLocations.includes('field') &&\n    // There's at least one language visible\n    filteredLanguages?.length > 0 &&\n    // Not every language has a value yet\n    !allLanguagesArePresent\n  const fieldHasMembers = members?.length > 0\n\n  return (\n    <Stack space={2}>\n      {fieldHasMembers ? (\n        <>\n          {filteredMembers.map((member) => {\n            if (member.kind === 'item') {\n              return (\n                <ArrayOfObjectsItem\n                  {...props}\n                  key={member.key}\n                  member={member}\n                />\n              )\n            }\n\n            return <MemberItemError key={member.key} member={member} />\n          })}\n        </>\n      ) : null}\n\n      {/* Give some feedback in the UI so the field doesn't look \"missing\" */}\n      {!addButtonsAreVisible && !fieldHasMembers ? (\n        <Card border tone=\"transparent\" padding={3} radius={2}>\n          <Text size={1}>\n            This internationalized field currently has no translations.\n          </Text>\n        </Card>\n      ) : null}\n\n      {addButtonsAreVisible ? (\n        <Stack space={2}>\n          <AddButtons\n            languages={filteredLanguages}\n            value={value}\n            readOnly={readOnly}\n            onClick={handleAddLanguage}\n          />\n          {buttonAddAll ? (\n            <Button\n              tone=\"primary\"\n              mode=\"ghost\"\n              disabled={readOnly || allLanguagesArePresent}\n              icon={AddIcon}\n              text={createAddAllTitle(value, filteredLanguages)}\n              onClick={handleAddLanguage}\n            />\n          ) : null}\n        </Stack>\n      ) : null}\n    </Stack>\n  )\n}\n", "import {SchemaType} from 'sanity'\n\nimport {ArrayFieldOptions} from '../schema/array'\n\nexport function getLanguagesFieldOption(\n  schemaType: SchemaType | undefined\n): ArrayFieldOptions['languages'] | undefined {\n  if (!schemaType) {\n    return undefined\n  }\n  const languagesOption = (schemaType.options as ArrayFieldOptions)?.languages\n  if (languagesOption) {\n    return languagesOption\n  }\n  return getLanguagesFieldOption(schemaType.type)\n}\n", "/* eslint-disable no-nested-ternary */\nimport {defineField, type FieldDefinition, type Rule} from 'sanity'\n\nimport {peek} from '../cache'\nimport {createFieldName} from '../components/createFieldName'\nimport {getSelectedValue} from '../components/getSelectedValue'\nimport InternationalizedArray from '../components/InternationalizedArray'\nimport type {Language, LanguageCallback, Value} from '../types'\nimport {getLanguagesFieldOption} from '../utils/getLanguagesFieldOption'\n\ntype ArrayFactoryConfig = {\n  apiVersion: string\n  select?: Record<string, string>\n  languages: Language[] | LanguageCallback\n  defaultLanguages?: string[]\n  type: string | FieldDefinition\n}\n\nexport type ArrayFieldOptions = Pick<\n  ArrayFactoryConfig,\n  'apiVersion' | 'select' | 'languages'\n>\n\nexport default (config: ArrayFactoryConfig): FieldDefinition<'array'> => {\n  const {apiVersion, select, languages, type} = config\n  const typeName = typeof type === `string` ? type : type.name\n  const arrayName = createFieldName(typeName)\n  const objectName = createFieldName(typeName, true)\n\n  return defineField({\n    name: arrayName,\n    title: 'Internationalized array',\n    type: 'array',\n    components: {\n      input: InternationalizedArray,\n    },\n    options: {\n      // @ts-expect-error - these options are required for validation rules – not the custom input component\n      apiVersion,\n      select,\n      languages,\n    },\n    of: [\n      defineField({\n        ...(typeof type === 'string' ? {} : type),\n        name: objectName,\n        type: objectName,\n      }),\n    ],\n    // @ts-expect-error - fix typings\n    validation: (rule: Rule) =>\n      rule.custom<Value[]>(async (value, context) => {\n        if (!value) {\n          return true\n        }\n\n        const selectedValue = getSelectedValue(select, context.document)\n        const client = context.getClient({apiVersion})\n\n        let contextLanguages: Language[] = []\n        const languagesFieldOption = getLanguagesFieldOption(context?.type)\n\n        if (Array.isArray(languagesFieldOption)) {\n          contextLanguages = languagesFieldOption\n        } else if (Array.isArray(peek(selectedValue))) {\n          contextLanguages = peek(selectedValue) || []\n        } else if (typeof languagesFieldOption === 'function') {\n          contextLanguages = await languagesFieldOption(client, selectedValue)\n        }\n\n        if (value && value.length > contextLanguages.length) {\n          return `Cannot be more than ${\n            contextLanguages.length === 1\n              ? `1 item`\n              : `${contextLanguages.length} items`\n          }`\n        }\n\n        const nonLanguageKeys = value?.length\n          ? value.filter(\n              (item) =>\n                !contextLanguages.find((language) => item._key === language.id)\n            )\n          : []\n        if (nonLanguageKeys.length) {\n          return {\n            message: `Array item keys must be valid languages registered to the field type`,\n            paths: nonLanguageKeys.map((item) => [{_key: item._key}]),\n          }\n        }\n\n        // Ensure there's no duplicate `language` fields\n        type KeyedValues = {\n          [key: string]: Value[]\n        }\n\n        const valuesByLanguage = value?.length\n          ? value\n              .filter((item) => Boolean(item?._key))\n              .reduce((acc, cur) => {\n                if (acc[cur._key]) {\n                  return {...acc, [cur._key]: [...acc[cur._key], cur]}\n                }\n                return {\n                  ...acc,\n                  [cur._key]: [cur],\n                }\n              }, {} as KeyedValues)\n          : {}\n        const duplicateValues = Object.values(valuesByLanguage)\n          .filter((item) => item?.length > 1)\n          .flat()\n        if (duplicateValues.length) {\n          return {\n            message: 'There can only be one field per language',\n            paths: duplicateValues.map((item) => [{_key: item._key}]),\n          }\n        }\n\n        return true\n      }),\n  })\n}\n", "import type {CardTone} from '@sanity/ui'\nimport type {FormNodeValidation} from 'sanity'\n\nexport function getToneFromValidation(\n  validations: FormNodeValidation[]\n): CardTone | undefined {\n  if (!validations?.length) {\n    return undefined\n  }\n\n  const validationLevels = validations.map((v) => v.level)\n\n  if (validationLevels.includes('error')) {\n    return `critical`\n  } else if (validationLevels.includes('warning')) {\n    return `caution`\n  }\n\n  return undefined\n}\n", "import {RemoveCircleIcon} from '@sanity/icons'\nimport {\n  Button,\n  Card,\n  Flex,\n  Label,\n  Menu,\n  MenuButton,\n  MenuItem,\n  Spinner,\n  Stack,\n  Text,\n  Tooltip,\n} from '@sanity/ui'\nimport type React from 'react'\nimport {ReactNode, useCallback, useMemo} from 'react'\nimport {type ObjectItemProps, useFormValue} from 'sanity'\nimport {set, unset} from 'sanity'\n\nimport {getLanguageDisplay} from '../utils/getLanguageDisplay'\nimport {getToneFromValidation} from './getToneFromValidation'\nimport {useInternationalizedArrayContext} from './InternationalizedArrayContext'\n\nexport type InternationalizedValue = {\n  _type: string\n  _key: string\n  value: string\n}\n\nexport default function InternationalizedInput(\n  props: ObjectItemProps<InternationalizedValue>\n): ReactNode {\n  const parentValue = useFormValue(\n    props.path.slice(0, -1)\n  ) as InternationalizedValue[]\n\n  const inlineProps = {\n    ...props.inputProps,\n    // This is the magic that makes inline editing work?\n    members: props.inputProps.members.filter(\n      (m) => m.kind === 'field' && m.name === 'value'\n    ),\n    // This just overrides the type\n    // Remove this as it shouldn't be necessary?\n    value: props.value as InternationalizedValue,\n  }\n\n  const {validation, value, onChange, readOnly} = inlineProps\n\n  // The parent array contains the languages from the plugin config\n  const {languages, languageDisplay, defaultLanguages} =\n    useInternationalizedArrayContext()\n\n  const languageKeysInUse = useMemo(\n    () => parentValue?.map((v) => v._key) ?? [],\n    [parentValue]\n  )\n  const keyIsValid = languages?.length\n    ? languages.find((l) => l.id === value._key)\n    : false\n\n  // Changes the key of this item, ideally to a valid language\n  const handleKeyChange = useCallback(\n    (event: React.MouseEvent<HTMLButtonElement, MouseEvent>): void => {\n      const languageId = event?.currentTarget?.value\n\n      if (\n        !value ||\n        !languages?.length ||\n        !languages.find((l) => l.id === languageId)\n      ) {\n        return\n      }\n\n      onChange([set(languageId, ['_key'])])\n    },\n    [onChange, value, languages]\n  )\n\n  // Removes this item from the array\n  const handleUnset = useCallback((): void => {\n    onChange(unset())\n  }, [onChange])\n\n  if (!languages) {\n    return <Spinner />\n  }\n\n  const language = languages.find((l) => l.id === value._key)\n  const languageTitle: string =\n    keyIsValid && language\n      ? getLanguageDisplay(languageDisplay, language.title, language.id)\n      : ''\n\n  const isDefault = defaultLanguages.includes(value._key)\n\n  const removeButton = (\n    <Button\n      mode=\"bleed\"\n      icon={RemoveCircleIcon}\n      tone=\"critical\"\n      disabled={readOnly || isDefault}\n      onClick={handleUnset}\n    />\n  )\n\n  return (\n    <Card paddingTop={2} tone={getToneFromValidation(validation)}>\n      <Stack space={2}>\n        <Card tone=\"inherit\">\n          {keyIsValid ? (\n            <Label muted size={1}>\n              {languageTitle}\n            </Label>\n          ) : (\n            <MenuButton\n              button={<Button fontSize={1} text={`Change \"${value._key}\"`} />}\n              id={`${value._key}-change-key`}\n              menu={\n                <Menu>\n                  {languages.map((lang) => (\n                    <MenuItem\n                      disabled={languageKeysInUse.includes(lang.id)}\n                      fontSize={1}\n                      key={lang.id}\n                      text={lang.id.toLocaleUpperCase()}\n                      value={lang.id}\n                      // @ts-expect-error - fix typings\n                      onClick={handleKeyChange}\n                    />\n                  ))}\n                </Menu>\n              }\n              popover={{portal: true}}\n            />\n          )}\n        </Card>\n        <Flex align=\"center\" gap={2}>\n          <Card flex={1} tone=\"inherit\">\n            {props.inputProps.renderInput(props.inputProps)}\n          </Card>\n\n          <Card tone=\"inherit\">\n            {isDefault ? (\n              <Tooltip\n                content={\n                  <Text muted size={1}>\n                    Can&apos;t remove default language\n                  </Text>\n                }\n                fallbackPlacements={['right', 'left']}\n                placement=\"top\"\n                portal\n              >\n                <span>{removeButton}</span>\n              </Tooltip>\n            ) : (\n              removeButton\n            )}\n          </Card>\n        </Flex>\n      </Stack>\n    </Card>\n  )\n}\n", "import {defineField, FieldDefinition} from 'sanity'\n\nimport {createFieldName} from '../components/createFieldName'\nimport InternationalizedInput from '../components/InternationalizedInput'\n\ntype ObjectFactoryConfig = {\n  type: string | FieldDefinition\n}\n\nexport default (config: ObjectFactoryConfig): FieldDefinition<'object'> => {\n  const {type} = config\n  const typeName = typeof type === `string` ? type : type.name\n  const objectName = createFieldName(typeName, true)\n\n  return defineField({\n    name: objectName,\n    title: `Internationalized array ${type}`,\n    type: 'object',\n    components: {\n      // @ts-expect-error - fix typings\n      item: InternationalizedInput,\n    },\n    fields: [\n      defineField({\n        ...(typeof type === 'string' ? {type} : type),\n        name: 'value',\n      }),\n    ],\n    preview: {\n      select: {\n        title: 'value',\n        subtitle: '_key',\n      },\n    },\n  })\n}\n", "import {\n  isDocumentSchemaType,\n  type ObjectField,\n  type Path,\n  type SchemaType,\n} from 'sanity'\n\ntype ObjectFieldWithPath = ObjectField<SchemaType> & {path: Path}\n\n/**\n * Flattens a document's schema type into a flat array of fields and includes their path\n */\nexport function flattenSchemaType(\n  schemaType: SchemaType\n): ObjectFieldWithPath[] {\n  if (!isDocumentSchemaType(schemaType)) {\n    console.error(`Schema type is not a document`)\n    return []\n  }\n\n  return extractInnerFields(schemaType.fields, [], 3)\n}\n\nfunction extractInnerFields(\n  fields: ObjectField<SchemaType>[],\n  path: Path,\n  maxDepth: number\n): ObjectFieldWithPath[] {\n  if (path.length >= maxDepth) {\n    return []\n  }\n\n  return fields.reduce<ObjectFieldWithPath[]>((acc, field) => {\n    const thisFieldWithPath = {path: [...path, field.name], ...field}\n\n    if (field.type.jsonType === 'object') {\n      const innerFields = extractInnerFields(\n        field.type.fields,\n        [...path, field.name],\n        maxDepth\n      )\n\n      return [...acc, thisFieldWithPath, ...innerFields]\n    } else if (\n      field.type.jsonType === 'array' &&\n      field.type.of.length &&\n      field.type.of.some((item) => 'fields' in item)\n    ) {\n      const innerFields = field.type.of.flatMap((innerField) =>\n        extractInnerFields(\n          // @ts-expect-error - Fix TS assertion for array fields\n          innerField.fields,\n          [...path, field.name],\n          maxDepth\n        )\n      )\n\n      return [...acc, thisFieldWithPath, ...innerFields]\n    }\n\n    return [...acc, thisFieldWithPath]\n  }, [])\n}\n", "import {definePlugin, isObjectInputProps} from 'sanity'\n\nimport {InternationalizedArrayProvider} from './components/InternationalizedArrayContext'\nimport InternationalizedField from './components/InternationalizedField'\nimport Preload from './components/Preload'\nimport {CONFIG_DEFAULT} from './constants'\nimport {internationalizedArrayFieldAction} from './fieldActions'\nimport array from './schema/array'\nimport object from './schema/object'\nimport {PluginConfig} from './types'\nimport {flattenSchemaType} from './utils/flattenSchemaType'\n\nexport const internationalizedArray = definePlugin<PluginConfig>((config) => {\n  const pluginConfig = {...CONFIG_DEFAULT, ...config}\n  const {\n    apiVersion = '2022-11-27',\n    select,\n    languages,\n    fieldTypes,\n    defaultLanguages,\n    buttonLocations,\n  } = pluginConfig\n\n  return {\n    name: 'sanity-plugin-internationalized-array',\n    // Preload languages for use throughout the Studio\n    studio: Array.isArray(languages)\n      ? undefined\n      : {\n          components: {\n            layout: (props) => (\n              <>\n                <Preload apiVersion={apiVersion} languages={languages} />\n                {props.renderDefault(props)}\n              </>\n            ),\n          },\n        },\n    // Optional: render \"add language\" buttons as field actions\n    document: {\n      unstable_fieldActions: buttonLocations.includes('unstable__fieldAction')\n        ? (prev) => [...prev, internationalizedArrayFieldAction]\n        : undefined,\n    },\n    // Wrap document editor with a language provider\n    form: {\n      components: {\n        field: (props) => <InternationalizedField {...props} />,\n\n        input: (props) => {\n          const isRootInput = props.id === 'root' && isObjectInputProps(props)\n\n          if (!isRootInput) {\n            return props.renderDefault(props)\n          }\n\n          const flatFieldTypeNames = flattenSchemaType(props.schemaType).map(\n            (field) => field.type.name\n          )\n          const hasInternationalizedArray = flatFieldTypeNames.some((name) =>\n            name.startsWith('internationalizedArray')\n          )\n\n          if (!hasInternationalizedArray) {\n            return props.renderDefault(props)\n          }\n\n          return (\n            <InternationalizedArrayProvider\n              {...props}\n              internationalizedArray={pluginConfig}\n            />\n          )\n        },\n      },\n    },\n    // Register custom schema types for the outer array and the inner object\n    schema: {\n      types: [\n        ...fieldTypes.map((type) =>\n          array({type, apiVersion, select, languages, defaultLanguages})\n        ),\n        ...fieldTypes.map((type) => object({type})),\n      ],\n    },\n  }\n})\n", "import {Preview, useSchema} from 'sanity'\nimport {Feedback} from 'sanity-plugin-utils'\n\ntype DocumentPreviewProps = {\n  value: unknown\n  type: string\n}\n\n// Wrapper of Preview just so that the schema type is satisfied by schema.get()\nexport default function DocumentPreview(props: DocumentPreviewProps) {\n  const schema = useSchema()\n\n  const schemaType = schema.get(props.type)\n  if (!schemaType) {\n    return <Feedback tone=\"critical\" title=\"Schema type not found\" />\n  }\n\n  return <Preview value={props.value} schemaType={schemaType} />\n}\n", "import type {PluginConfigContext} from './types'\n\nexport const METADATA_SCHEMA_NAME = `translation.metadata`\nexport const TRANSLATIONS_ARRAY_NAME = `translations`\nexport const API_VERSION = `2023-05-22`\nexport const DEFAULT_CONFIG: PluginConfigContext = {\n  supportedLanguages: [],\n  schemaTypes: [],\n  languageField: `language`,\n  weakReferences: false,\n  bulkPublish: false,\n  metadataFields: [],\n  apiVersion: API_VERSION,\n  allowCreateMetaDoc: false,\n  callback: null,\n}\n", "import type {SanityDocument} from 'sanity'\n\nimport {METADATA_SCHEMA_NAME} from '../../constants'\n\nexport function separateReferences(data: SanityDocument[] | null = []): {\n  translations: SanityDocument[]\n  otherReferences: SanityDocument[]\n} {\n  const translations: SanityDocument[] = []\n  const otherReferences: SanityDocument[] = []\n\n  if (data && data.length > 0) {\n    data.forEach((doc) => {\n      if (doc._type === METADATA_SCHEMA_NAME) {\n        translations.push(doc)\n      } else {\n        otherReferences.push(doc)\n      }\n    })\n  }\n\n  return {translations, otherReferences}\n}\n", "import {Card, Flex, Spinner, Stack, Text} from '@sanity/ui'\nimport {useEffect, useMemo} from 'react'\nimport type {SanityDocument} from 'sanity'\nimport {useListeningQuery} from 'sanity-plugin-utils'\n\nimport DocumentPreview from './DocumentPreview'\nimport {separateReferences} from './separateReferences'\n\ntype DeleteTranslationDialogProps = {\n  doc: SanityDocument\n  documentId: string\n  setTranslations: (translations: SanityDocument[]) => void\n}\n\nexport default function DeleteTranslationDialog(\n  props: DeleteTranslationDialogProps\n) {\n  const {doc, documentId, setTranslations} = props\n\n  // Get all references and check if any of them are translations metadata\n  const {data, loading} = useListeningQuery<SanityDocument[]>(\n    `*[references($id)]{_id, _type}`,\n    {params: {id: documentId}, initialValue: []}\n  )\n  const {translations, otherReferences} = useMemo(\n    () => separateReferences(data),\n    [data]\n  )\n\n  useEffect(() => {\n    setTranslations(translations)\n  }, [setTranslations, translations])\n\n  if (loading) {\n    return (\n      <Flex padding={4} align=\"center\" justify=\"center\">\n        <Spinner />\n      </Flex>\n    )\n  }\n\n  return (\n    <Stack space={4}>\n      {translations && translations.length > 0 ? (\n        <Text>\n          This document is a language-specific version which other translations\n          depend on.\n        </Text>\n      ) : (\n        <Text>This document does not have connected translations.</Text>\n      )}\n      <Card border padding={3}>\n        <Stack space={4}>\n          <Text size={1} weight=\"semibold\">\n            {translations && translations.length > 0 ? (\n              <>Before this document can be deleted</>\n            ) : (\n              <>This document can now be deleted</>\n            )}\n          </Text>\n          <DocumentPreview value={doc} type={doc._type} />\n          {translations && translations.length > 0 ? (\n            <>\n              <Card borderTop />\n              <Text size={1} weight=\"semibold\">\n                The reference in{' '}\n                {translations.length === 1\n                  ? `this translations document`\n                  : `these translations documents`}{' '}\n                must be removed\n              </Text>\n              {translations.map((translation) => (\n                <DocumentPreview\n                  key={translation._id}\n                  value={translation}\n                  type={translation._type}\n                />\n              ))}\n            </>\n          ) : null}\n          {otherReferences && otherReferences.length > 0 ? (\n            <>\n              <Card borderTop />\n              <Text size={1} weight=\"semibold\">\n                {otherReferences.length === 1\n                  ? `There is an additional reference`\n                  : `There are additional references`}{' '}\n                to this document\n              </Text>\n              {otherReferences.map((reference) => (\n                <DocumentPreview\n                  key={reference._id}\n                  value={reference}\n                  type={reference._type}\n                />\n              ))}\n            </>\n          ) : null}\n        </Stack>\n      </Card>\n      {otherReferences.length === 0 ? (\n        <Text>This document has no other references.</Text>\n      ) : (\n        <Text>\n          You may not be able to delete this document because other documents\n          refer to it.\n        </Text>\n      )}\n    </Stack>\n  )\n}\n", "import {Button, Grid} from '@sanity/ui'\n\ntype DeleteTranslationFooterProps = {\n  translations: unknown[]\n  onClose: () => void\n  onProceed: () => void\n}\n\nexport default function DeleteTranslationFooter(\n  props: DeleteTranslationFooterProps\n) {\n  const {translations, onClose, onProceed} = props\n\n  return (\n    <Grid columns={2} gap={2}>\n      <Button text=\"Cancel\" onClick={onClose} mode=\"ghost\" />\n      <Button\n        text={\n          translations && translations.length > 0\n            ? `Unset translation reference`\n            : `Delete document`\n        }\n        onClick={onProceed}\n        tone=\"critical\"\n      />\n    </Grid>\n  )\n}\n", "const isPromise = promise => typeof promise === 'object' && typeof promise.then === 'function';\n\nconst globalCache = [];\n\nfunction shallowEqualArrays(arrA, arrB, equal = (a, b) => a === b) {\n  if (arrA === arrB) return true;\n  if (!arrA || !arrB) return false;\n  const len = arrA.length;\n  if (arrB.length !== len) return false;\n\n  for (let i = 0; i < len; i++) if (!equal(arrA[i], arrB[i])) return false;\n\n  return true;\n}\n\nfunction query(fn, keys = null, preload = false, config = {}) {\n  // If no keys were given, the function is the key\n  if (keys === null) keys = [fn];\n\n  for (const entry of globalCache) {\n    // Find a match\n    if (shallowEqualArrays(keys, entry.keys, entry.equal)) {\n      // If we're pre-loading and the element is present, just return\n      if (preload) return undefined; // If an error occurred, throw\n\n      if (Object.prototype.hasOwnProperty.call(entry, 'error')) throw entry.error; // If a response was successful, return\n\n      if (Object.prototype.hasOwnProperty.call(entry, 'response')) {\n        if (config.lifespan && config.lifespan > 0) {\n          if (entry.timeout) clearTimeout(entry.timeout);\n          entry.timeout = setTimeout(entry.remove, config.lifespan);\n        }\n\n        return entry.response;\n      } // If the promise is still unresolved, throw\n\n\n      if (!preload) throw entry.promise;\n    }\n  } // The request is new or has changed.\n\n\n  const entry = {\n    keys,\n    equal: config.equal,\n    remove: () => {\n      const index = globalCache.indexOf(entry);\n      if (index !== -1) globalCache.splice(index, 1);\n    },\n    promise: // Execute the promise\n    (isPromise(fn) ? fn : fn(...keys) // When it resolves, store its value\n    ).then(response => {\n      entry.response = response; // Remove the entry in time if a lifespan was given\n\n      if (config.lifespan && config.lifespan > 0) {\n        entry.timeout = setTimeout(entry.remove, config.lifespan);\n      }\n    }) // Store caught errors, they will be thrown in the render-phase to bubble into an error-bound\n    .catch(error => entry.error = error)\n  }; // Register the entry\n\n  globalCache.push(entry); // And throw the promise, this yields control back to React\n\n  if (!preload) throw entry.promise;\n  return undefined;\n}\n\nconst suspend = (fn, keys, config) => query(fn, keys, false, config);\n\nconst preload = (fn, keys, config) => void query(fn, keys, true, config);\n\nconst peek = keys => {\n  var _globalCache$find;\n\n  return (_globalCache$find = globalCache.find(entry => shallowEqualArrays(keys, entry.keys, entry.equal))) == null ? void 0 : _globalCache$find.response;\n};\n\nconst clear = keys => {\n  if (keys === undefined || keys.length === 0) globalCache.splice(0, globalCache.length);else {\n    const entry = globalCache.find(entry => shallowEqualArrays(keys, entry.keys, entry.equal));\n    if (entry) entry.remove();\n  }\n};\n\nexport { clear, peek, preload, suspend };\n", "import {useContext} from 'react'\nimport {createContext} from 'react'\nimport {type LayoutProps, useClient, useWorkspace} from 'sanity'\nimport {suspend} from 'suspend-react'\n\nimport {DEFAULT_CONFIG} from '../constants'\nimport type {PluginConfig, PluginConfigContext} from '../types'\n\nconst DocumentInternationalizationContext =\n  createContext<PluginConfigContext>(DEFAULT_CONFIG)\n\nexport function useDocumentInternationalizationContext() {\n  return useContext(DocumentInternationalizationContext)\n}\n\ntype DocumentInternationalizationProviderProps = LayoutProps & {\n  pluginConfig: Required<PluginConfig>\n}\n\n/**\n * This Provider wraps the Studio and provides the DocumentInternationalization context to document actions and components.\n */\nexport function DocumentInternationalizationProvider(\n  props: DocumentInternationalizationProviderProps\n) {\n  const {pluginConfig} = props\n\n  const client = useClient({apiVersion: pluginConfig.apiVersion})\n  const workspace = useWorkspace()\n  const supportedLanguages = Array.isArray(pluginConfig.supportedLanguages)\n    ? pluginConfig.supportedLanguages\n    : // eslint-disable-next-line require-await\n      suspend(async () => {\n        if (typeof pluginConfig.supportedLanguages === 'function') {\n          return pluginConfig.supportedLanguages(client)\n        }\n        return pluginConfig.supportedLanguages\n      }, [workspace])\n\n  return (\n    <DocumentInternationalizationContext.Provider\n      value={{...pluginConfig, supportedLanguages}}\n    >\n      {props.renderDefault(props)}\n    </DocumentInternationalizationContext.Provider>\n  )\n}\n", "import {TrashIcon} from '@sanity/icons'\nimport {type ButtonTone, useToast} from '@sanity/ui'\nimport {useCallback, useState} from 'react'\nimport {\n  type DocumentActionComponent,\n  type SanityDocument,\n  useClient,\n} from 'sanity'\n\nimport DeleteTranslationDialog from '../components/DeleteTranslationDialog'\nimport DeleteTranslationFooter from '../components/DeleteTranslationFooter'\nimport {useDocumentInternationalizationContext} from '../components/DocumentInternationalizationContext'\nimport {API_VERSION, TRANSLATIONS_ARRAY_NAME} from '../constants'\n\nexport const DeleteTranslationAction: DocumentActionComponent = (props) => {\n  const {id: documentId, published, draft} = props\n  const doc = draft || published\n  const {languageField} = useDocumentInternationalizationContext()\n\n  const [isDialogOpen, setDialogOpen] = useState(false)\n  const [translations, setTranslations] = useState<SanityDocument[]>([])\n  const onClose = useCallback(() => setDialogOpen(false), [])\n  const documentLanguage = doc ? doc[languageField] : null\n\n  const toast = useToast()\n  const client = useClient({apiVersion: API_VERSION})\n\n  // Remove translation reference and delete document in one transaction\n  const onProceed = useCallback(() => {\n    const tx = client.transaction()\n    let operation = 'DELETE'\n\n    if (documentLanguage && translations.length > 0) {\n      operation = 'UNSET'\n      translations.forEach((translation) => {\n        tx.patch(translation._id, (patch) =>\n          patch.unset([\n            `${TRANSLATIONS_ARRAY_NAME}[_key == \"${documentLanguage}\"]`,\n          ])\n        )\n      })\n    } else {\n      tx.delete(documentId)\n      tx.delete(`drafts.${documentId}`)\n    }\n\n    tx.commit()\n      .then(() => {\n        if (operation === 'DELETE') {\n          onClose()\n        }\n        toast.push({\n          status: 'success',\n          title:\n            operation === 'UNSET'\n              ? 'Translation reference unset'\n              : 'Document deleted',\n          description:\n            operation === 'UNSET' ? 'The document can now be deleted' : null,\n        })\n      })\n      .catch((err) => {\n        toast.push({\n          status: 'error',\n          title:\n            operation === 'unset'\n              ? 'Failed to unset translation reference'\n              : 'Failed to delete document',\n          description: err.message,\n        })\n      })\n  }, [client, documentLanguage, translations, documentId, onClose, toast])\n\n  return {\n    label: `Delete translation...`,\n    disabled: !doc || !documentLanguage,\n    icon: TrashIcon,\n    tone: 'critical' as ButtonTone,\n    onHandle: () => {\n      setDialogOpen(true)\n    },\n    dialog: isDialogOpen && {\n      type: 'dialog',\n      onClose,\n      header: 'Delete translation',\n      content: doc ? (\n        <DeleteTranslationDialog\n          doc={doc}\n          documentId={documentId}\n          setTranslations={setTranslations}\n        />\n      ) : null,\n      footer: (\n        <DeleteTranslationFooter\n          onClose={onClose}\n          onProceed={onProceed}\n          translations={translations}\n        />\n      ),\n    },\n  }\n}\n", "/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n  return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose;\n    if (async) {\n        if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n        dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n        if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n        dispose = value[Symbol.dispose];\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  function next() {\n    while (env.stack.length) {\n      var rec = env.stack.pop();\n      try {\n        var result = rec.dispose && rec.dispose.call(rec.value);\n        if (rec.async) return Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n      }\n      catch (e) {\n          fail(e);\n      }\n    }\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n};\n", "export function isFunction(value) {\n    return typeof value === 'function';\n}\n//# sourceMappingURL=isFunction.js.map", "export function createErrorClass(createImpl) {\n    var _super = function (instance) {\n        Error.call(instance);\n        instance.stack = new Error().stack;\n    };\n    var ctorFunc = createImpl(_super);\n    ctorFunc.prototype = Object.create(Error.prototype);\n    ctorFunc.prototype.constructor = ctorFunc;\n    return ctorFunc;\n}\n//# sourceMappingURL=createErrorClass.js.map", "import { createErrorClass } from './createErrorClass';\nexport var UnsubscriptionError = createErrorClass(function (_super) {\n    return function UnsubscriptionErrorImpl(errors) {\n        _super(this);\n        this.message = errors\n            ? errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) { return i + 1 + \") \" + err.toString(); }).join('\\n  ')\n            : '';\n        this.name = 'UnsubscriptionError';\n        this.errors = errors;\n    };\n});\n//# sourceMappingURL=UnsubscriptionError.js.map", "export function arrRemove(arr, item) {\n    if (arr) {\n        var index = arr.indexOf(item);\n        0 <= index && arr.splice(index, 1);\n    }\n}\n//# sourceMappingURL=arrRemove.js.map", "import { __read, __spreadArray, __values } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { UnsubscriptionError } from './util/UnsubscriptionError';\nimport { arrRemove } from './util/arrRemove';\nvar Subscription = (function () {\n    function Subscription(initialTeardown) {\n        this.initialTeardown = initialTeardown;\n        this.closed = false;\n        this._parentage = null;\n        this._finalizers = null;\n    }\n    Subscription.prototype.unsubscribe = function () {\n        var e_1, _a, e_2, _b;\n        var errors;\n        if (!this.closed) {\n            this.closed = true;\n            var _parentage = this._parentage;\n            if (_parentage) {\n                this._parentage = null;\n                if (Array.isArray(_parentage)) {\n                    try {\n                        for (var _parentage_1 = __values(_parentage), _parentage_1_1 = _parentage_1.next(); !_parentage_1_1.done; _parentage_1_1 = _parentage_1.next()) {\n                            var parent_1 = _parentage_1_1.value;\n                            parent_1.remove(this);\n                        }\n                    }\n                    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                    finally {\n                        try {\n                            if (_parentage_1_1 && !_parentage_1_1.done && (_a = _parentage_1.return)) _a.call(_parentage_1);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                    }\n                }\n                else {\n                    _parentage.remove(this);\n                }\n            }\n            var initialFinalizer = this.initialTeardown;\n            if (isFunction(initialFinalizer)) {\n                try {\n                    initialFinalizer();\n                }\n                catch (e) {\n                    errors = e instanceof UnsubscriptionError ? e.errors : [e];\n                }\n            }\n            var _finalizers = this._finalizers;\n            if (_finalizers) {\n                this._finalizers = null;\n                try {\n                    for (var _finalizers_1 = __values(_finalizers), _finalizers_1_1 = _finalizers_1.next(); !_finalizers_1_1.done; _finalizers_1_1 = _finalizers_1.next()) {\n                        var finalizer = _finalizers_1_1.value;\n                        try {\n                            execFinalizer(finalizer);\n                        }\n                        catch (err) {\n                            errors = errors !== null && errors !== void 0 ? errors : [];\n                            if (err instanceof UnsubscriptionError) {\n                                errors = __spreadArray(__spreadArray([], __read(errors)), __read(err.errors));\n                            }\n                            else {\n                                errors.push(err);\n                            }\n                        }\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (_finalizers_1_1 && !_finalizers_1_1.done && (_b = _finalizers_1.return)) _b.call(_finalizers_1);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n            if (errors) {\n                throw new UnsubscriptionError(errors);\n            }\n        }\n    };\n    Subscription.prototype.add = function (teardown) {\n        var _a;\n        if (teardown && teardown !== this) {\n            if (this.closed) {\n                execFinalizer(teardown);\n            }\n            else {\n                if (teardown instanceof Subscription) {\n                    if (teardown.closed || teardown._hasParent(this)) {\n                        return;\n                    }\n                    teardown._addParent(this);\n                }\n                (this._finalizers = (_a = this._finalizers) !== null && _a !== void 0 ? _a : []).push(teardown);\n            }\n        }\n    };\n    Subscription.prototype._hasParent = function (parent) {\n        var _parentage = this._parentage;\n        return _parentage === parent || (Array.isArray(_parentage) && _parentage.includes(parent));\n    };\n    Subscription.prototype._addParent = function (parent) {\n        var _parentage = this._parentage;\n        this._parentage = Array.isArray(_parentage) ? (_parentage.push(parent), _parentage) : _parentage ? [_parentage, parent] : parent;\n    };\n    Subscription.prototype._removeParent = function (parent) {\n        var _parentage = this._parentage;\n        if (_parentage === parent) {\n            this._parentage = null;\n        }\n        else if (Array.isArray(_parentage)) {\n            arrRemove(_parentage, parent);\n        }\n    };\n    Subscription.prototype.remove = function (teardown) {\n        var _finalizers = this._finalizers;\n        _finalizers && arrRemove(_finalizers, teardown);\n        if (teardown instanceof Subscription) {\n            teardown._removeParent(this);\n        }\n    };\n    Subscription.EMPTY = (function () {\n        var empty = new Subscription();\n        empty.closed = true;\n        return empty;\n    })();\n    return Subscription;\n}());\nexport { Subscription };\nexport var EMPTY_SUBSCRIPTION = Subscription.EMPTY;\nexport function isSubscription(value) {\n    return (value instanceof Subscription ||\n        (value && 'closed' in value && isFunction(value.remove) && isFunction(value.add) && isFunction(value.unsubscribe)));\n}\nfunction execFinalizer(finalizer) {\n    if (isFunction(finalizer)) {\n        finalizer();\n    }\n    else {\n        finalizer.unsubscribe();\n    }\n}\n//# sourceMappingURL=Subscription.js.map", "export var config = {\n    onUnhandledError: null,\n    onStoppedNotification: null,\n    Promise: undefined,\n    useDeprecatedSynchronousErrorHandling: false,\n    useDeprecatedNextContext: false,\n};\n//# sourceMappingURL=config.js.map", "import { __read, __spreadArray } from \"tslib\";\nexport var timeoutProvider = {\n    setTimeout: function (handler, timeout) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        var delegate = timeoutProvider.delegate;\n        if (delegate === null || delegate === void 0 ? void 0 : delegate.setTimeout) {\n            return delegate.setTimeout.apply(delegate, __spreadArray([handler, timeout], __read(args)));\n        }\n        return setTimeout.apply(void 0, __spreadArray([handler, timeout], __read(args)));\n    },\n    clearTimeout: function (handle) {\n        var delegate = timeoutProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearTimeout) || clearTimeout)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=timeoutProvider.js.map", "import { config } from '../config';\nimport { timeoutProvider } from '../scheduler/timeoutProvider';\nexport function reportUnhandledError(err) {\n    timeoutProvider.setTimeout(function () {\n        var onUnhandledError = config.onUnhandledError;\n        if (onUnhandledError) {\n            onUnhandledError(err);\n        }\n        else {\n            throw err;\n        }\n    });\n}\n//# sourceMappingURL=reportUnhandledError.js.map", "export function noop() { }\n//# sourceMappingURL=noop.js.map", "import { __extends } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { isSubscription, Subscription } from './Subscription';\nimport { config } from './config';\nimport { reportUnhandledError } from './util/reportUnhandledError';\nimport { noop } from './util/noop';\nimport { nextNotification, errorNotification, COMPLETE_NOTIFICATION } from './NotificationFactories';\nimport { timeoutProvider } from './scheduler/timeoutProvider';\nimport { captureError } from './util/errorContext';\nvar Subscriber = (function (_super) {\n    __extends(Subscriber, _super);\n    function Subscriber(destination) {\n        var _this = _super.call(this) || this;\n        _this.isStopped = false;\n        if (destination) {\n            _this.destination = destination;\n            if (isSubscription(destination)) {\n                destination.add(_this);\n            }\n        }\n        else {\n            _this.destination = EMPTY_OBSERVER;\n        }\n        return _this;\n    }\n    Subscriber.create = function (next, error, complete) {\n        return new SafeSubscriber(next, error, complete);\n    };\n    Subscriber.prototype.next = function (value) {\n        if (this.isStopped) {\n            handleStoppedNotification(nextNotification(value), this);\n        }\n        else {\n            this._next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (this.isStopped) {\n            handleStoppedNotification(errorNotification(err), this);\n        }\n        else {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    Subscriber.prototype.complete = function () {\n        if (this.isStopped) {\n            handleStoppedNotification(COMPLETE_NOTIFICATION, this);\n        }\n        else {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (!this.closed) {\n            this.isStopped = true;\n            _super.prototype.unsubscribe.call(this);\n            this.destination = null;\n        }\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        try {\n            this.destination.error(err);\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    Subscriber.prototype._complete = function () {\n        try {\n            this.destination.complete();\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    return Subscriber;\n}(Subscription));\nexport { Subscriber };\nvar _bind = Function.prototype.bind;\nfunction bind(fn, thisArg) {\n    return _bind.call(fn, thisArg);\n}\nvar ConsumerObserver = (function () {\n    function ConsumerObserver(partialObserver) {\n        this.partialObserver = partialObserver;\n    }\n    ConsumerObserver.prototype.next = function (value) {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.next) {\n            try {\n                partialObserver.next(value);\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n    };\n    ConsumerObserver.prototype.error = function (err) {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.error) {\n            try {\n                partialObserver.error(err);\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n        else {\n            handleUnhandledError(err);\n        }\n    };\n    ConsumerObserver.prototype.complete = function () {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.complete) {\n            try {\n                partialObserver.complete();\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n    };\n    return ConsumerObserver;\n}());\nvar SafeSubscriber = (function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        var partialObserver;\n        if (isFunction(observerOrNext) || !observerOrNext) {\n            partialObserver = {\n                next: (observerOrNext !== null && observerOrNext !== void 0 ? observerOrNext : undefined),\n                error: error !== null && error !== void 0 ? error : undefined,\n                complete: complete !== null && complete !== void 0 ? complete : undefined,\n            };\n        }\n        else {\n            var context_1;\n            if (_this && config.useDeprecatedNextContext) {\n                context_1 = Object.create(observerOrNext);\n                context_1.unsubscribe = function () { return _this.unsubscribe(); };\n                partialObserver = {\n                    next: observerOrNext.next && bind(observerOrNext.next, context_1),\n                    error: observerOrNext.error && bind(observerOrNext.error, context_1),\n                    complete: observerOrNext.complete && bind(observerOrNext.complete, context_1),\n                };\n            }\n            else {\n                partialObserver = observerOrNext;\n            }\n        }\n        _this.destination = new ConsumerObserver(partialObserver);\n        return _this;\n    }\n    return SafeSubscriber;\n}(Subscriber));\nexport { SafeSubscriber };\nfunction handleUnhandledError(error) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n        captureError(error);\n    }\n    else {\n        reportUnhandledError(error);\n    }\n}\nfunction defaultErrorHandler(err) {\n    throw err;\n}\nfunction handleStoppedNotification(notification, subscriber) {\n    var onStoppedNotification = config.onStoppedNotification;\n    onStoppedNotification && timeoutProvider.setTimeout(function () { return onStoppedNotification(notification, subscriber); });\n}\nexport var EMPTY_OBSERVER = {\n    closed: true,\n    next: noop,\n    error: defaultErrorHandler,\n    complete: noop,\n};\n//# sourceMappingURL=Subscriber.js.map", "import { isFunction } from './isFunction';\nexport function hasLift(source) {\n    return isFunction(source === null || source === void 0 ? void 0 : source.lift);\n}\nexport function operate(init) {\n    return function (source) {\n        if (hasLift(source)) {\n            return source.lift(function (liftedSource) {\n                try {\n                    return init(liftedSource, this);\n                }\n                catch (err) {\n                    this.error(err);\n                }\n            });\n        }\n        throw new TypeError('Unable to lift unknown Observable type');\n    };\n}\n//# sourceMappingURL=lift.js.map", "import { __extends } from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nexport function createOperatorSubscriber(destination, onNext, onComplete, onError, onFinalize) {\n    return new OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize);\n}\nvar OperatorSubscriber = (function (_super) {\n    __extends(OperatorSubscriber, _super);\n    function OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize, shouldUnsubscribe) {\n        var _this = _super.call(this, destination) || this;\n        _this.onFinalize = onFinalize;\n        _this.shouldUnsubscribe = shouldUnsubscribe;\n        _this._next = onNext\n            ? function (value) {\n                try {\n                    onNext(value);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n            }\n            : _super.prototype._next;\n        _this._error = onError\n            ? function (err) {\n                try {\n                    onError(err);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._error;\n        _this._complete = onComplete\n            ? function () {\n                try {\n                    onComplete();\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._complete;\n        return _this;\n    }\n    OperatorSubscriber.prototype.unsubscribe = function () {\n        var _a;\n        if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {\n            var closed_1 = this.closed;\n            _super.prototype.unsubscribe.call(this);\n            !closed_1 && ((_a = this.onFinalize) === null || _a === void 0 ? void 0 : _a.call(this));\n        }\n    };\n    return OperatorSubscriber;\n}(Subscriber));\nexport { OperatorSubscriber };\n//# sourceMappingURL=OperatorSubscriber.js.map", "import { createErrorClass } from './createErrorClass';\nexport var EmptyError = createErrorClass(function (_super) { return function EmptyErrorImpl() {\n    _super(this);\n    this.name = 'EmptyError';\n    this.message = 'no elements in sequence';\n}; });\n//# sourceMappingURL=EmptyError.js.map", "import { EmptyError } from './util/EmptyError';\nimport { SafeSubscriber } from './Subscriber';\nexport function firstValueFrom(source, config) {\n    var hasConfig = typeof config === 'object';\n    return new Promise(function (resolve, reject) {\n        var subscriber = new SafeSubscriber({\n            next: function (value) {\n                resolve(value);\n                subscriber.unsubscribe();\n            },\n            error: reject,\n            complete: function () {\n                if (hasConfig) {\n                    resolve(config.defaultValue);\n                }\n                else {\n                    reject(new EmptyError());\n                }\n            },\n        });\n        source.subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=firstValueFrom.js.map", "import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function filter(predicate, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return predicate.call(thisArg, value, index++) && subscriber.next(value); }));\n    });\n}\n//# sourceMappingURL=filter.js.map", "import {useListeningQuery} from 'sanity-plugin-utils'\n\nimport {METADATA_SCHEMA_NAME} from '../constants'\nimport type {Metadata} from '../types'\n\n// Using references() seemed less reliable for updating the listener\n// results than querying raw values in the array\n// AFAIK: references is _faster_ when querying with GROQ\n// const query = `*[_type == $translationSchema && references($id)]`\nconst query = `*[_type == $translationSchema && $id in translations[].value._ref]{\n  _id,\n  _createdAt,\n  translations\n}`\n\nexport function useTranslationMetadata(id: string): {\n  data: Metadata[] | null\n  loading: boolean\n  error: boolean | unknown | ProgressEvent\n} {\n  const {data, loading, error} = useListeningQuery<Metadata[]>(query, {\n    params: {id, translationSchema: METADATA_SCHEMA_NAME},\n  })\n\n  return {data, loading, error}\n}\n", "import {defineLocaleResourceBundle} from 'sanity'\n\n/**\n * The locale namespace for the document internationalization plugin.\n *\n * @public\n */\nexport const documenti18nLocaleNamespace =\n  'document-internationalization' as const\n\n/**\n * The default locale bundle for the document internationalization plugin, which is US English.\n *\n * @internal\n */\nexport const documentInternationalizationUsEnglishLocaleBundle =\n  defineLocaleResourceBundle({\n    locale: 'en-US',\n    namespace: documenti18nLocaleNamespace,\n    resources: () => import('./resources'),\n  })\n", "import {CopyIcon} from '@sanity/icons'\nimport {useToast} from '@sanity/ui'\nimport {uuid} from '@sanity/uuid'\nimport {useCallback, useMemo, useState} from 'react'\nimport {filter, firstValueFrom} from 'rxjs'\nimport {\n  DEFAULT_STUDIO_CLIENT_OPTIONS,\n  type DocumentActionComponent,\n  type Id,\n  InsufficientPermissionsMessage,\n  type PatchOperations,\n  useClient,\n  useCurrentUser,\n  useDocumentOperation,\n  useDocumentPairPermissions,\n  useDocumentStore,\n  useTranslation,\n} from 'sanity'\nimport {useRouter} from 'sanity/router'\nimport {structureLocaleNamespace} from 'sanity/structure'\n\nimport {METADATA_SCHEMA_NAME, TRANSLATIONS_ARRAY_NAME} from '../constants'\nimport {useTranslationMetadata} from '../hooks/useLanguageMetadata'\nimport {documenti18nLocaleNamespace} from '../i18n'\n\nconst DISABLED_REASON_KEY = {\n  METADATA_NOT_FOUND: 'action.duplicate.disabled.missing-metadata',\n  MULTIPLE_METADATA: 'action.duplicate.disabled.multiple-metadata',\n  NOTHING_TO_DUPLICATE: 'action.duplicate.disabled.nothing-to-duplicate',\n  NOT_READY: 'action.duplicate.disabled.not-ready',\n}\n\nexport const DuplicateWithTranslationsAction: DocumentActionComponent = ({\n  id,\n  type,\n  onComplete,\n}) => {\n  const documentStore = useDocumentStore()\n  const {duplicate} = useDocumentOperation(id, type)\n  const {navigateIntent} = useRouter()\n  const [isDuplicating, setDuplicating] = useState(false)\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'duplicate',\n  })\n  const {data, loading: isMetadataDocumentLoading} = useTranslationMetadata(id)\n  const hasOneMetadataDocument = useMemo(() => {\n    return Array.isArray(data) && data.length <= 1\n  }, [data])\n  const metadataDocument = Array.isArray(data) && data.length ? data[0] : null\n  const client = useClient(DEFAULT_STUDIO_CLIENT_OPTIONS)\n  const toast = useToast()\n  const {t: s} = useTranslation(structureLocaleNamespace)\n  const {t: d} = useTranslation(documenti18nLocaleNamespace)\n  const currentUser = useCurrentUser()\n\n  const handle = useCallback(async () => {\n    setDuplicating(true)\n\n    try {\n      if (!metadataDocument) {\n        throw new Error('Metadata document not found')\n      }\n\n      // 1. Duplicate the document and its localized versions\n      const translations = new Map<string, Id>()\n      await Promise.all(\n        metadataDocument[TRANSLATIONS_ARRAY_NAME].map(async (translation) => {\n          const dupeId = uuid()\n          const locale = translation._key\n          const docId = translation.value?._ref\n\n          if (!docId) {\n            throw new Error('Translation document not found')\n          }\n\n          const {duplicate: duplicateTranslation} = await firstValueFrom(\n            documentStore.pair\n              .editOperations(docId, type)\n              .pipe(filter((op) => op.duplicate.disabled !== 'NOT_READY'))\n          )\n\n          if (duplicateTranslation.disabled) {\n            throw new Error('Cannot duplicate document')\n          }\n\n          const duplicateTranslationSuccess = firstValueFrom(\n            documentStore.pair\n              .operationEvents(docId, type)\n              .pipe(filter((e) => e.op === 'duplicate' && e.type === 'success'))\n          )\n          duplicateTranslation.execute(dupeId)\n          await duplicateTranslationSuccess\n\n          translations.set(locale, dupeId)\n        })\n      )\n\n      // 2. Duplicate the metadata document\n      const {duplicate: duplicateMetadata} = await firstValueFrom(\n        documentStore.pair\n          .editOperations(metadataDocument._id, METADATA_SCHEMA_NAME)\n          .pipe(filter((op) => op.duplicate.disabled !== 'NOT_READY'))\n      )\n\n      if (duplicateMetadata.disabled) {\n        throw new Error('Cannot duplicate document')\n      }\n\n      const duplicateMetadataSuccess = firstValueFrom(\n        documentStore.pair\n          .operationEvents(metadataDocument._id, METADATA_SCHEMA_NAME)\n          .pipe(filter((e) => e.op === 'duplicate' && e.type === 'success'))\n      )\n      const dupeId = uuid()\n      duplicateMetadata.execute(dupeId)\n      await duplicateMetadataSuccess\n\n      // 3. Patch the duplicated metadata document to update the references\n      // TODO: use document store\n      // const {patch: patchMetadata} = await firstValueFrom(\n      //   documentStore.pair\n      //     .editOperations(dupeId, METADATA_SCHEMA_NAME)\n      //     .pipe(filter((op) => op.patch.disabled !== 'NOT_READY'))\n      // )\n\n      // if (patchMetadata.disabled) {\n      //   throw new Error('Cannot patch document')\n      // }\n\n      // await firstValueFrom(\n      //   documentStore.pair\n      //     .consistencyStatus(dupeId, METADATA_SCHEMA_NAME)\n      //     .pipe(filter((isConsistant) => isConsistant))\n      // )\n\n      // const patchMetadataSuccess = firstValueFrom(\n      //   documentStore.pair\n      //     .operationEvents(dupeId, METADATA_SCHEMA_NAME)\n      //     .pipe(filter((e) => e.op === 'patch' && e.type === 'success'))\n      // )\n\n      const patch: PatchOperations = {\n        set: Object.fromEntries(\n          Array.from(translations.entries()).map(([locale, documentId]) => [\n            `${TRANSLATIONS_ARRAY_NAME}[_key == \"${locale}\"].value._ref`,\n            documentId,\n          ])\n        ),\n      }\n\n      // patchMetadata.execute([patch])\n      // await patchMetadataSuccess\n      await client.transaction().patch(dupeId, patch).commit()\n\n      // 4. Navigate to the duplicated document\n      navigateIntent('edit', {\n        id: Array.from(translations.values()).at(0),\n        type,\n      })\n\n      onComplete()\n    } catch (error) {\n      console.error(error)\n      toast.push({\n        status: 'error',\n        title: 'Error duplicating document',\n        description:\n          error instanceof Error\n            ? error.message\n            : 'Failed to duplicate document',\n      })\n    } finally {\n      setDuplicating(false)\n    }\n  }, [\n    client,\n    documentStore.pair,\n    metadataDocument,\n    navigateIntent,\n    onComplete,\n    toast,\n    type,\n  ])\n\n  return useMemo(() => {\n    if (!isPermissionsLoading && !permissions?.granted) {\n      return {\n        icon: CopyIcon,\n        disabled: true,\n        label: d('action.duplicate.label'),\n        title: (\n          <InsufficientPermissionsMessage\n            context=\"duplicate-document\"\n            currentUser={currentUser}\n          />\n        ),\n      }\n    }\n\n    if (!isMetadataDocumentLoading && !metadataDocument) {\n      return {\n        icon: CopyIcon,\n        disabled: true,\n        label: d('action.duplicate.label'),\n        title: d(DISABLED_REASON_KEY.METADATA_NOT_FOUND),\n      }\n    }\n\n    if (!hasOneMetadataDocument) {\n      return {\n        icon: CopyIcon,\n        disabled: true,\n        label: d('action.duplicate.label'),\n        title: d(DISABLED_REASON_KEY.MULTIPLE_METADATA),\n      }\n    }\n\n    return {\n      icon: CopyIcon,\n      disabled:\n        isDuplicating ||\n        Boolean(duplicate.disabled) ||\n        isPermissionsLoading ||\n        isMetadataDocumentLoading,\n      label: isDuplicating\n        ? s('action.duplicate.running.label')\n        : d('action.duplicate.label'),\n      title: duplicate.disabled\n        ? s(DISABLED_REASON_KEY[duplicate.disabled])\n        : '',\n      onHandle: handle,\n    }\n  }, [\n    currentUser,\n    duplicate.disabled,\n    handle,\n    hasOneMetadataDocument,\n    isDuplicating,\n    isMetadataDocumentLoading,\n    isPermissionsLoading,\n    metadataDocument,\n    permissions?.granted,\n    s,\n    d,\n  ])\n}\n\nDuplicateWithTranslationsAction.action = 'duplicate'\n// @ts-expect-error `displayName` is used by React DevTools\nDuplicateWithTranslationsAction.displayName = 'DuplicateWithTranslationsAction'\n", "import {useCallback, useContext} from 'react'\nimport {RouterContext} from 'sanity/router'\nimport {usePaneRouter} from 'sanity/structure'\n\nexport function useOpenInNewPane(id?: string | null, type?: string) {\n  const routerContext = useContext(RouterContext)\n  const {routerPanesState, groupIndex} = usePaneRouter()\n\n  const openInNewPane = useCallback(() => {\n    if (!routerContext || !id || !type) {\n      return\n    }\n\n    // No panes open, function might be called outside Structure\n    if (!routerPanesState.length) {\n      routerContext.navigateIntent('edit', {id, type})\n      return\n    }\n\n    const panes = [...routerPanesState]\n    panes.splice(groupIndex + 1, 0, [\n      {\n        id: id,\n        params: {type},\n      },\n    ])\n\n    const href = routerContext.resolvePathFromState({panes})\n    routerContext.navigateUrl({path: href})\n  }, [id, type, routerContext, routerPanesState, groupIndex])\n\n  return openInNewPane\n}\n", "import type {TranslationReference} from '../types'\n\nexport function createReference(\n  key: string,\n  ref: string,\n  type: string,\n  strengthenOnPublish: boolean = true\n): TranslationReference {\n  return {\n    _key: key,\n    _type: 'internationalizedArrayReferenceValue',\n    value: {\n      _type: 'reference',\n      _ref: ref,\n      _weak: true,\n      // If the user has configured weakReferences, we won't want to strengthen them\n      ...(strengthenOnPublish ? {_strengthenOnPublish: {type}} : {}),\n    },\n  }\n}\n", "import {CogIcon} from '@sanity/icons'\nimport {Box, Button, Stack, Text, Tooltip} from '@sanity/ui'\nimport {useCallback, useState} from 'react'\nimport {type ObjectSchemaType, useClient} from 'sanity'\n\nimport {METADATA_SCHEMA_NAME} from '../constants'\nimport {useOpenInNewPane} from '../hooks/useOpenInNewPane'\nimport {createReference} from '../utils/createReference'\nimport {useDocumentInternationalizationContext} from './DocumentInternationalizationContext'\n\ntype LanguageManageProps = {\n  id?: string\n  metadataId?: string | null\n  schemaType: ObjectSchemaType\n  documentId: string\n  sourceLanguageId?: string\n}\n\nexport default function LanguageManage(props: LanguageManageProps) {\n  const {id, metadataId, schemaType, documentId, sourceLanguageId} = props\n  const open = useOpenInNewPane(id, METADATA_SCHEMA_NAME)\n  const openCreated = useOpenInNewPane(metadataId, METADATA_SCHEMA_NAME)\n  const {allowCreateMetaDoc, apiVersion, weakReferences} =\n    useDocumentInternationalizationContext()\n  const client = useClient({apiVersion})\n  const [userHasClicked, setUserHasClicked] = useState(false)\n\n  const canCreate = !id && Boolean(metadataId) && allowCreateMetaDoc\n\n  const handleClick = useCallback(() => {\n    if (!id && metadataId && sourceLanguageId) {\n      /* Disable button while this request is pending */\n      setUserHasClicked(true)\n\n      // handle creation of meta document\n      const transaction = client.transaction()\n\n      const sourceReference = createReference(\n        sourceLanguageId,\n        documentId,\n        schemaType.name,\n        !weakReferences\n      )\n      const newMetadataDocument = {\n        _id: metadataId,\n        _type: METADATA_SCHEMA_NAME,\n        schemaTypes: [schemaType.name],\n        translations: [sourceReference],\n      }\n\n      transaction.createIfNotExists(newMetadataDocument)\n\n      transaction\n        .commit()\n        .then(() => {\n          setUserHasClicked(false)\n          openCreated()\n        })\n        .catch((err) => {\n          console.error(err)\n          setUserHasClicked(false)\n        })\n    } else {\n      open()\n    }\n  }, [\n    id,\n    metadataId,\n    sourceLanguageId,\n    client,\n    documentId,\n    schemaType.name,\n    weakReferences,\n    openCreated,\n    open,\n  ])\n\n  const disabled =\n    (!id && !canCreate) || (canCreate && !sourceLanguageId) || userHasClicked\n\n  return (\n    <Tooltip\n      animate\n      content={\n        <Box padding={2}>\n          <Text muted size={1}>\n            Document has no other translations\n          </Text>\n        </Box>\n      }\n      fallbackPlacements={['right', 'left']}\n      placement=\"top\"\n      portal\n      disabled={Boolean(id) || canCreate}\n    >\n      <Stack>\n        <Button\n          disabled={disabled}\n          mode=\"ghost\"\n          text=\"Manage Translations\"\n          icon={CogIcon}\n          loading={userHasClicked}\n          onClick={handleClick}\n        />\n      </Stack>\n    </Tooltip>\n  )\n}\n", "import {extractWithPath, Mutation} from '@sanity/mutator'\nimport {\n  isDocumentSchemaType,\n  type ObjectSchemaType,\n  type Path,\n  pathToString,\n  type SanityDocument,\n  type SchemaType,\n} from 'sanity'\n\nexport interface DocumentMember {\n  schemaType: SchemaType\n  path: Path\n  name: string\n  value: unknown\n}\n\nexport function removeExcludedPaths(\n  doc: SanityDocument | null,\n  schemaType: ObjectSchemaType\n): SanityDocument | null {\n  // If the supplied doc is null or the schemaType\n  // isn't a document, return as is.\n  if (!isDocumentSchemaType(schemaType) || !doc) {\n    return doc\n  }\n\n  // The extractPaths function gets all the fields in the doc with\n  // a value, along with their schemaTypes and paths. We'll end up\n  // with an array of paths in string form which we want to exclude\n  const pathsToExclude: string[] = extractPaths(doc, schemaType, [])\n    // We filter for any fields which should be excluded from the document\n    // duplicate action, based on the schemaType option being set.\n    .filter(\n      (field) =>\n        field.schemaType?.options?.documentInternationalization?.exclude ===\n        true\n    )\n    // then we return the stringified version of the path\n    .map((field) => {\n      return pathToString(field.path)\n    })\n\n  // Now we can use the Mutation class from @sanity/mutator to patch the document\n  // to remove all the paths that are for one of the excluded fields. This is just\n  // done locally, and the documents themselves are not patched in the Content Lake.\n  const mut = new Mutation({\n    mutations: [\n      {\n        patch: {\n          id: doc._id,\n          unset: pathsToExclude,\n        },\n      },\n    ],\n  })\n\n  return mut.apply(doc) as SanityDocument\n}\n\nfunction extractPaths(\n  doc: SanityDocument,\n  schemaType: ObjectSchemaType,\n  path: Path\n): DocumentMember[] {\n  return schemaType.fields.reduce<DocumentMember[]>((acc, field) => {\n    const fieldPath = [...path, field.name]\n    const fieldSchema = field.type\n    const {value} = extractWithPath(pathToString(fieldPath), doc)[0] ?? {}\n    if (!value) {\n      return acc\n    }\n\n    const thisFieldWithPath: DocumentMember = {\n      path: fieldPath,\n      name: field.name,\n      schemaType: fieldSchema,\n      value,\n    }\n\n    if (fieldSchema.jsonType === 'object') {\n      const innerFields = extractPaths(doc, fieldSchema, fieldPath)\n\n      return [...acc, thisFieldWithPath, ...innerFields]\n    } else if (\n      fieldSchema.jsonType === 'array' &&\n      fieldSchema.of.length &&\n      fieldSchema.of.some((item) => 'fields' in item)\n    ) {\n      const {value: arrayValue} =\n        extractWithPath(pathToString(fieldPath), doc)[0] ?? {}\n\n      let arrayPaths: DocumentMember[] = []\n      if ((arrayValue as any)?.length) {\n        for (const item of arrayValue as any[]) {\n          const itemPath = [...fieldPath, {_key: item._key}]\n          let itemSchema = fieldSchema.of.find((t) => t.name === item._type)\n          if (!item._type) {\n            itemSchema = fieldSchema.of[0]\n          }\n          if (item._key && itemSchema) {\n            const innerFields = extractPaths(\n              doc,\n              itemSchema as ObjectSchemaType,\n              itemPath\n            )\n            const arrayMember = {\n              path: itemPath,\n              name: item._key,\n              schemaType: itemSchema,\n              value: item,\n            }\n            arrayPaths = [...arrayPaths, arrayMember, ...innerFields]\n          }\n        }\n      }\n\n      return [...acc, thisFieldWithPath, ...arrayPaths]\n    }\n\n    return [...acc, thisFieldWithPath]\n  }, [])\n}\n", "import {AddIcon, CheckmarkIcon, SplitVerticalIcon} from '@sanity/icons'\nimport {\n  Badge,\n  Box,\n  Button,\n  Flex,\n  Spinner,\n  Text,\n  Tooltip,\n  useToast,\n} from '@sanity/ui'\nimport {uuid} from '@sanity/uuid'\nimport {useCallback, useEffect, useState} from 'react'\nimport {type ObjectSchemaType, type SanityDocument, useClient} from 'sanity'\n\nimport {METADATA_SCHEMA_NAME} from '../constants'\nimport {useOpenInNewPane} from '../hooks/useOpenInNewPane'\nimport type {\n  Language,\n  Metadata,\n  MetadataDocument,\n  TranslationReference,\n} from '../types'\nimport {createReference} from '../utils/createReference'\nimport {removeExcludedPaths} from '../utils/excludePaths'\nimport {useDocumentInternationalizationContext} from './DocumentInternationalizationContext'\n\ntype LanguageOptionProps = {\n  language: Language\n  schemaType: ObjectSchemaType\n  documentId: string\n  disabled: boolean\n  current: boolean\n  source: SanityDocument | null\n  metadataId: string | null\n  metadata?: Metadata | null\n  sourceLanguageId?: string\n}\n\nexport default function LanguageOption(props: LanguageOptionProps) {\n  const {\n    language,\n    schemaType,\n    documentId,\n    current,\n    source,\n    sourceLanguageId,\n    metadata,\n    metadataId,\n  } = props\n  /* When the user has clicked the Create button, the button should be disabled\n   * to prevent double-clicks from firing onCreate twice. This creates duplicate\n   * translation metadata entries, which editors will not be able to delete */\n  const [userHasClicked, setUserHasClicked] = useState(false)\n  const disabled =\n    props.disabled ||\n    userHasClicked ||\n    current ||\n    !source ||\n    !sourceLanguageId ||\n    !metadataId\n  const translation: TranslationReference | undefined = metadata?.translations\n    .length\n    ? metadata.translations.find((t) => t._key === language.id)\n    : undefined\n  const {apiVersion, languageField, weakReferences, callback} =\n    useDocumentInternationalizationContext()\n  const client = useClient({apiVersion})\n  const toast = useToast()\n\n  const open = useOpenInNewPane(translation?.value?._ref, schemaType.name)\n  const handleOpen = useCallback(() => open(), [open])\n\n  /* Once a translation has been created, reset the userHasClicked state to false\n   * so they can click on it to navigate to the translation. If a translation already\n   * existed when this component was mounted, this will have no effect. */\n  const hasTranslation = Boolean(translation)\n  useEffect(() => {\n    setUserHasClicked(false)\n  }, [hasTranslation])\n\n  const handleCreate = useCallback(async () => {\n    if (!source) {\n      throw new Error(`Cannot create translation without source document`)\n    }\n\n    if (!sourceLanguageId) {\n      throw new Error(`Cannot create translation without source language ID`)\n    }\n\n    if (!metadataId) {\n      throw new Error(`Cannot create translation without a metadata ID`)\n    }\n    /* Disable the create button while this request is pending */\n    setUserHasClicked(true)\n\n    const transaction = client.transaction()\n\n    // 1. Duplicate source document\n    const newTranslationDocumentId = uuid()\n    let newTranslationDocument = {\n      ...source,\n      _id: `drafts.${newTranslationDocumentId}`,\n      // 2. Update language of the translation\n      [languageField]: language.id,\n    }\n\n    // Remove fields / paths we don't want to duplicate\n    newTranslationDocument = removeExcludedPaths(\n      newTranslationDocument,\n      schemaType\n    ) as SanityDocument\n\n    transaction.create(newTranslationDocument)\n\n    // 3. Maybe create the metadata document\n    const sourceReference = createReference(\n      sourceLanguageId,\n      documentId,\n      schemaType.name,\n      !weakReferences\n    )\n    const newTranslationReference = createReference(\n      language.id,\n      newTranslationDocumentId,\n      schemaType.name,\n      !weakReferences\n    )\n    const newMetadataDocument: MetadataDocument = {\n      _id: metadataId,\n      _type: METADATA_SCHEMA_NAME,\n      schemaTypes: [schemaType.name],\n      translations: [sourceReference],\n    }\n\n    transaction.createIfNotExists(newMetadataDocument)\n\n    // 4. Patch translation to metadata document\n    // Note: If the document was only just created in the operation above\n    // This patch operation will have no effect\n    const metadataPatch = client\n      .patch(metadataId)\n      .setIfMissing({translations: [sourceReference]})\n      .insert(`after`, `translations[-1]`, [newTranslationReference])\n\n    transaction.patch(metadataPatch)\n\n    // 5. Commit!\n    transaction\n      .commit()\n      .then(() => {\n        const metadataExisted = Boolean(metadata?._createdAt)\n\n        callback?.({\n          client,\n          sourceLanguageId,\n          sourceDocument: source,\n          newDocument: newTranslationDocument,\n          destinationLanguageId: language.id,\n          metaDocumentId: metadataId,\n        }).catch((err) => {\n          toast.push({\n            status: 'error',\n            title: `Callback`,\n            description: `Error while running callback - ${err}.`,\n          })\n        })\n\n        return toast.push({\n          status: 'success',\n          title: `Created \"${language.title}\" translation`,\n          description: metadataExisted\n            ? `Updated Translations Metadata`\n            : `Created Translations Metadata`,\n        })\n      })\n      .catch((err) => {\n        console.error(err)\n\n        /* Re-enable the create button if there was an error */\n        setUserHasClicked(false)\n\n        return toast.push({\n          status: 'error',\n          title: `Error creating translation`,\n          description: err.message,\n        })\n      })\n  }, [\n    client,\n    documentId,\n    language.id,\n    language.title,\n    languageField,\n    metadata?._createdAt,\n    metadataId,\n    schemaType,\n    source,\n    sourceLanguageId,\n    toast,\n    weakReferences,\n    callback,\n  ])\n\n  let message\n\n  if (current) {\n    message = `Current document`\n  } else if (translation) {\n    message = `Open ${language.title} translation`\n  } else if (!translation) {\n    message = `Create new ${language.title} translation`\n  }\n\n  return (\n    <Tooltip\n      animate\n      content={\n        <Box padding={2}>\n          <Text muted size={1}>\n            {message}\n          </Text>\n        </Box>\n      }\n      fallbackPlacements={['right', 'left']}\n      placement=\"top\"\n      portal\n    >\n      <Button\n        onClick={translation ? handleOpen : handleCreate}\n        mode={current && disabled ? `default` : `bleed`}\n        disabled={disabled}\n      >\n        <Flex gap={3} align=\"center\">\n          {disabled && !current ? (\n            <Spinner />\n          ) : (\n            <Text size={2}>\n              {/* eslint-disable-next-line no-nested-ternary */}\n              {translation ? (\n                <SplitVerticalIcon />\n              ) : current ? (\n                <CheckmarkIcon />\n              ) : (\n                <AddIcon />\n              )}\n            </Text>\n          )}\n          <Box flex={1}>\n            <Text>{language.title}</Text>\n          </Box>\n          <Badge tone={disabled || current ? `default` : `primary`}>\n            {language.id}\n          </Badge>\n        </Flex>\n      </Button>\n    </Tooltip>\n  )\n}\n", "import {EditIcon} from '@sanity/icons'\nimport {Badge, Box, Button, Flex, Text, useToast} from '@sanity/ui'\nimport {useCallback} from 'react'\nimport {type SanityDocument, useClient} from 'sanity'\n\nimport type {Language} from '../types'\nimport {useDocumentInternationalizationContext} from './DocumentInternationalizationContext'\n\ntype LanguagePatchProps = {\n  language: Language\n  source: SanityDocument | null\n  disabled: boolean\n}\n\nexport default function LanguagePatch(props: LanguagePatchProps) {\n  const {language, source} = props\n  const {apiVersion, languageField} = useDocumentInternationalizationContext()\n  const disabled = props.disabled || !source\n  const client = useClient({apiVersion})\n  const toast = useToast()\n\n  const handleClick = useCallback(() => {\n    if (!source) {\n      throw new Error(`Cannot patch missing document`)\n    }\n\n    const currentId = source._id\n\n    client\n      .patch(currentId)\n      .set({[languageField]: language.id})\n      .commit()\n      .then(() => {\n        toast.push({\n          title: `Set document language to ${language.title}`,\n          status: `success`,\n        })\n      })\n      .catch((err) => {\n        console.error(err)\n\n        return toast.push({\n          title: `Failed to set document language to ${language.title}`,\n          status: `error`,\n        })\n      })\n  }, [source, client, languageField, language, toast])\n\n  return (\n    <Button\n      mode=\"bleed\"\n      onClick={handleClick}\n      disabled={disabled}\n      justify=\"flex-start\"\n    >\n      <Flex gap={3} align=\"center\">\n        <Text size={2}>\n          <EditIcon />\n        </Text>\n        <Box flex={1}>\n          <Text>{language.title}</Text>\n        </Box>\n        <Badge>{language.id}</Badge>\n      </Flex>\n    </Button>\n  )\n}\n", "import {Box} from '@sanity/ui'\nimport {styled} from 'styled-components'\n\nexport default styled(Box)`\n  max-width: 280px;\n`\n", "import {Card, Flex, Text} from '@sanity/ui'\nimport type {PropsWithChildren} from 'react'\n\nimport ConstrainedBox from './ConstrainedBox'\n\nexport default function Warning({children}: PropsWithChildren) {\n  return (\n    <Card tone=\"caution\" padding={3}>\n      <Flex justify=\"center\">\n        <ConstrainedBox>\n          <Text size={1} align=\"center\">\n            {children}\n          </Text>\n        </ConstrainedBox>\n      </Flex>\n    </Card>\n  )\n}\n", "import {TranslateIcon} from '@sanity/icons'\nimport {\n  Box,\n  Button,\n  Card,\n  Popover,\n  Stack,\n  Text,\n  TextInput,\n  useClickOutside,\n} from '@sanity/ui'\nimport {uuid} from '@sanity/uuid'\nimport {type FormEvent, useCallback, useMemo, useState} from 'react'\nimport {useEditState} from 'sanity'\n\nimport {useTranslationMetadata} from '../hooks/useLanguageMetadata'\nimport type {DocumentInternationalizationMenuProps} from '../types'\nimport {useDocumentInternationalizationContext} from './DocumentInternationalizationContext'\nimport LanguageManage from './LanguageManage'\nimport LanguageOption from './LanguageOption'\nimport LanguagePatch from './LanguagePatch'\nimport Warning from './Warning'\n\nexport function DocumentInternationalizationMenu(\n  props: DocumentInternationalizationMenuProps\n) {\n  const {documentId} = props\n  const schemaType = props.schemaType\n  const {languageField, supportedLanguages} =\n    useDocumentInternationalizationContext()\n\n  // Search filter query\n  const [query, setQuery] = useState(``)\n  const handleQuery = useCallback((event: FormEvent<HTMLInputElement>) => {\n    if (event.currentTarget.value) {\n      setQuery(event.currentTarget.value)\n    } else {\n      setQuery(``)\n    }\n  }, [])\n\n  // UI Handlers\n  const [open, setOpen] = useState(false)\n  const handleClick = useCallback(() => setOpen((o) => !o), [])\n  const [button, setButton] = useState<HTMLElement | null>(null)\n  const [popover, setPopover] = useState<HTMLElement | null>(null)\n  const handleClickOutside = useCallback(() => setOpen(false), [])\n  useClickOutside(handleClickOutside, [button, popover])\n\n  // Get metadata from content lake\n  const {data, loading, error} = useTranslationMetadata(documentId)\n  const metadata = Array.isArray(data) && data.length ? data[0] : null\n\n  // Optimistically set a metadata ID for a newly created metadata document\n  // Cannot rely on generated metadata._id from useTranslationMetadata\n  // As the document store might not have returned it before creating another translation\n  const metadataId = useMemo(() => {\n    if (loading) {\n      return null\n    }\n\n    // Once created, these two values should be the same anyway\n    return metadata?._id ?? uuid()\n  }, [loading, metadata?._id])\n\n  // Duplicate a new language version from the most recent version of this document\n  const {draft, published} = useEditState(documentId, schemaType.name)\n  const source = draft || published\n\n  // Check for data issues\n  const documentIsInOneMetadataDocument = useMemo(() => {\n    return Array.isArray(data) && data.length <= 1\n  }, [data])\n  const sourceLanguageId = source?.[languageField] as string | undefined\n  const sourceLanguageIsValid = supportedLanguages.some(\n    (l) => l.id === sourceLanguageId\n  )\n  const allLanguagesAreValid = useMemo(() => {\n    const valid = supportedLanguages.every((l) => l.id && l.title)\n    if (!valid) {\n      console.warn(\n        `Not all languages are valid. It should be an array of objects with an \"id\" and \"title\" property. Or a function that returns an array of objects with an \"id\" and \"title\" property.`,\n        supportedLanguages\n      )\n    }\n\n    return valid\n  }, [supportedLanguages])\n\n  const content = (\n    <Box padding={1}>\n      {error ? (\n        <Card tone=\"critical\" padding={1}>\n          <Text>There was an error returning translations metadata</Text>\n        </Card>\n      ) : (\n        <Stack space={1}>\n          <LanguageManage\n            id={metadata?._id}\n            documentId={documentId}\n            metadataId={metadataId}\n            schemaType={schemaType}\n            sourceLanguageId={sourceLanguageId}\n          />\n          {supportedLanguages.length > 4 ? (\n            <TextInput\n              onChange={handleQuery}\n              value={query}\n              placeholder=\"Filter languages\"\n            />\n          ) : null}\n          {supportedLanguages.length > 0 ? (\n            <>\n              {/* Once metadata is loaded, there may be issues */}\n              {loading ? null : (\n                <>\n                  {/* Not all languages are valid */}\n                  {data && documentIsInOneMetadataDocument ? null : (\n                    <Warning>\n                      {/* TODO: Surface these documents to the user */}\n                      This document has been found in more than one Translations\n                      Metadata documents\n                    </Warning>\n                  )}\n                  {/* Not all languages are valid */}\n                  {allLanguagesAreValid ? null : (\n                    <Warning>\n                      Not all language objects are valid. See the console.\n                    </Warning>\n                  )}\n                  {/* Current document has no language field */}\n                  {sourceLanguageId ? null : (\n                    <Warning>\n                      Choose a language to apply to{' '}\n                      <strong>this Document</strong>\n                    </Warning>\n                  )}\n                  {/* Current document has an invalid language field */}\n                  {sourceLanguageId && !sourceLanguageIsValid ? (\n                    <Warning>\n                      Select a supported language. Current language value:{' '}\n                      <code>{sourceLanguageId}</code>\n                    </Warning>\n                  ) : null}\n                </>\n              )}\n              {supportedLanguages\n                .filter((language) => {\n                  if (query) {\n                    return language.title\n                      .toLowerCase()\n                      .includes(query.toLowerCase())\n                  }\n                  return true\n                })\n                .map((language) =>\n                  !loading && sourceLanguageId && sourceLanguageIsValid ? (\n                    // Button to duplicate this document to a new translation\n                    // And either create or update the metadata document\n                    <LanguageOption\n                      key={language.id}\n                      language={language}\n                      schemaType={schemaType}\n                      documentId={documentId}\n                      disabled={loading || !allLanguagesAreValid}\n                      current={language.id === sourceLanguageId}\n                      metadata={metadata}\n                      metadataId={metadataId}\n                      source={source}\n                      sourceLanguageId={sourceLanguageId}\n                    />\n                  ) : (\n                    // Button to set a language field on *this* document\n                    <LanguagePatch\n                      key={language.id}\n                      source={source}\n                      language={language}\n                      // Only allow language patch change to:\n                      // - Keys not in metadata\n                      // - The key of this document in the metadata\n                      disabled={\n                        (loading ||\n                          !allLanguagesAreValid ||\n                          metadata?.translations\n                            .filter((t) => t?.value?._ref !== documentId)\n                            .some((t) => t._key === language.id)) ??\n                        false\n                      }\n                    />\n                  )\n                )}\n            </>\n          ) : null}\n        </Stack>\n      )}\n    </Box>\n  )\n\n  const issueWithTranslations =\n    !loading && sourceLanguageId && !sourceLanguageIsValid\n\n  if (!documentId) {\n    return null\n  }\n\n  if (!schemaType || !schemaType.name) {\n    return null\n  }\n\n  return (\n    <Popover\n      animate\n      constrainSize\n      content={content}\n      open={open}\n      portal\n      ref={setPopover}\n      overflow=\"auto\"\n      tone=\"default\"\n    >\n      <Button\n        text=\"Translations\"\n        mode=\"bleed\"\n        disabled={!source}\n        tone={\n          !source || loading || !issueWithTranslations ? undefined : `caution`\n        }\n        icon={TranslateIcon}\n        onClick={handleClick}\n        ref={setButton}\n        selected={open}\n      />\n    </Popover>\n  )\n}\n", "import {TrashIcon} from '@sanity/icons'\nimport {type ButtonTone, useToast} from '@sanity/ui'\nimport {useCallback, useMemo, useState} from 'react'\nimport {\n  type DocumentActionComponent,\n  type KeyedObject,\n  type Reference,\n  type TypedObject,\n  useClient,\n} from 'sanity'\n\nimport {API_VERSION, TRANSLATIONS_ARRAY_NAME} from '../constants'\n\ntype TranslationReference = TypedObject &\n  KeyedObject & {\n    value: Reference\n  }\n\nexport const DeleteMetadataAction: DocumentActionComponent = (props) => {\n  const {id: documentId, published, draft, onComplete} = props\n  const doc = draft || published\n\n  const [isDialogOpen, setDialogOpen] = useState(false)\n  const onClose = useCallback(() => setDialogOpen(false), [])\n  const translations: TranslationReference[] = useMemo(\n    () =>\n      doc && Array.isArray(doc[TRANSLATIONS_ARRAY_NAME])\n        ? (doc[TRANSLATIONS_ARRAY_NAME] as TranslationReference[])\n        : [],\n    [doc]\n  )\n\n  const toast = useToast()\n  const client = useClient({apiVersion: API_VERSION})\n\n  // Remove translation reference and delete document in one transaction\n  const onProceed = useCallback(() => {\n    const tx = client.transaction()\n\n    tx.patch(documentId, (patch) => patch.unset([TRANSLATIONS_ARRAY_NAME]))\n\n    if (translations.length > 0) {\n      translations.forEach((translation) => {\n        tx.delete(translation.value._ref)\n        tx.delete(`drafts.${translation.value._ref}`)\n      })\n    }\n\n    tx.delete(documentId)\n    // Shouldn't exist as this document type is in liveEdit\n    tx.delete(`drafts.${documentId}`)\n\n    tx.commit()\n      .then(() => {\n        onClose()\n\n        toast.push({\n          status: 'success',\n          title: 'Deleted document and translations',\n        })\n      })\n      .catch((err) => {\n        toast.push({\n          status: 'error',\n          title: 'Failed to delete document and translations',\n          description: err.message,\n        })\n      })\n  }, [client, translations, documentId, onClose, toast])\n\n  return {\n    label: `Delete all translations`,\n    disabled: !doc || !translations.length,\n    icon: TrashIcon,\n    tone: 'critical' as ButtonTone,\n    onHandle: () => {\n      setDialogOpen(true)\n    },\n    dialog: isDialogOpen && {\n      type: 'confirm',\n      onCancel: onComplete,\n      onConfirm: () => {\n        onProceed()\n        onComplete()\n      },\n      tone: 'critical' as ButtonTone,\n      message:\n        translations.length === 1\n          ? `Delete 1 translation and this document`\n          : `Delete all ${translations.length} translations and this document`,\n    },\n  }\n}\n", "import type {DocumentBadgeDescription, DocumentBadgeProps} from 'sanity'\n\nimport {useDocumentInternationalizationContext} from '../components/DocumentInternationalizationContext'\n\nexport function LanguageBadge(\n  props: DocumentBadgeProps\n): DocumentBadgeDescription | null {\n  const source = props?.draft || props?.published\n  const {languageField, supportedLanguages} =\n    useDocumentInternationalizationContext()\n  const languageId = source?.[languageField]\n\n  if (!languageId) {\n    return null\n  }\n\n  const language = Array.isArray(supportedLanguages)\n    ? supportedLanguages.find((l) => l.id === languageId)\n    : null\n\n  // Currently we only show the language id if the supportedLanguages are async\n  return {\n    label: language?.id ?? String(languageId),\n    title: language?.title ?? undefined,\n    color: `primary`,\n  }\n}\n", "import {Card, Spinner} from '@sanity/ui'\nimport {useEffect, useMemo} from 'react'\nimport {Preview, useEditState, useSchema, useValidationStatus} from 'sanity'\n\ntype DocumentCheckProps = {\n  id: string\n  onCheckComplete: (id: string) => void\n  addInvalidId: (id: string) => void\n  removeInvalidId: (id: string) => void\n  addDraftId: (id: string) => void\n  removeDraftId: (id: string) => void\n}\n\n// Check if the document has a draft\n// Check if that draft is valid\n// Report back to parent that it can be added to bulk publish\nexport default function DocumentCheck(props: DocumentCheckProps) {\n  const {\n    id,\n    onCheckComplete,\n    addInvalidId,\n    removeInvalidId,\n    addDraftId,\n    removeDraftId,\n  } = props\n  const editState = useEditState(id, ``)\n  const {isValidating, validation} = useValidationStatus(id, ``)\n  const schema = useSchema()\n\n  const validationHasErrors = useMemo(() => {\n    return (\n      !isValidating &&\n      validation.length > 0 &&\n      validation.some((item) => item.level === 'error')\n    )\n  }, [isValidating, validation])\n\n  useEffect(() => {\n    if (validationHasErrors) {\n      addInvalidId(id)\n    } else {\n      removeInvalidId(id)\n    }\n\n    if (editState.draft) {\n      addDraftId(id)\n    } else {\n      removeDraftId(id)\n    }\n\n    if (!isValidating) {\n      onCheckComplete(id)\n    }\n  }, [\n    addDraftId,\n    addInvalidId,\n    editState.draft,\n    id,\n    isValidating,\n    onCheckComplete,\n    removeDraftId,\n    removeInvalidId,\n    validationHasErrors,\n  ])\n\n  // We only care about drafts\n  if (!editState.draft) {\n    return null\n  }\n\n  const schemaType = schema.get(editState.draft._type)\n\n  return (\n    <Card\n      border\n      padding={2}\n      tone={validationHasErrors ? `critical` : `positive`}\n    >\n      {editState.draft && schemaType ? (\n        <Preview\n          layout=\"default\"\n          value={editState.draft}\n          schemaType={schemaType}\n        />\n      ) : (\n        <Spinner />\n      )}\n    </Card>\n  )\n}\n", "import {Box, type ButtonTone, Text, Tooltip} from '@sanity/ui'\nimport type {ComponentType, PropsWithChildren} from 'react'\nimport {TextWithTone} from 'sanity'\n\ntype InfoIconProps = PropsWithChildren & {\n  icon: ComponentType\n  tone: ButtonTone\n  text?: string\n}\n\nexport default function InfoIcon(props: InfoIconProps) {\n  const {text, icon, tone, children} = props\n  const Icon = icon\n\n  return (\n    <Tooltip\n      animate\n      portal\n      content={\n        children ? (\n          <>{children}</>\n        ) : (\n          <Box padding={2}>\n            <Text size={1}>{text}</Text>\n          </Box>\n        )\n      }\n    >\n      <TextWithTone tone={tone} size={1}>\n        <Icon />\n      </TextWithTone>\n    </Tooltip>\n  )\n}\n", "import {InfoOutlineIcon} from '@sanity/icons'\nimport {Box, Stack, Text} from '@sanity/ui'\n\nimport InfoIcon from './InfoIcon'\n\nexport default function Info() {\n  return (\n    <InfoIcon icon={InfoOutlineIcon} tone=\"primary\">\n      <Stack padding={3} space={4} style={{maxWidth: 250}}>\n        <Box>\n          <Text size={1}>Bulk publishing uses the Scheduling API.</Text>\n        </Box>\n        <Box>\n          <Text size={1}>\n            Customized Document Actions in the Studio will not execute. Webhooks\n            will execute.\n          </Text>\n        </Box>\n        <Box>\n          <Text size={1}>\n            Validation is checked before rendering the button below, but the\n            Scheduling API will not check for – or enforce – validation.\n          </Text>\n        </Box>\n      </Stack>\n    </InfoIcon>\n  )\n}\n", "import {Button, Card, Dialog, Inline, Stack, Text, useToast} from '@sanity/ui'\nimport {useCallback, useState} from 'react'\nimport {TextWithTone, useClient, useWorkspace} from 'sanity'\n\nimport {API_VERSION} from '../../constants'\nimport type {TranslationReference} from '../../types'\nimport DocumentCheck from './DocumentCheck'\nimport Info from './Info'\n\nexport type BulkPublishProps = {\n  translations: TranslationReference[]\n}\n\n// A root-level component with UI for hitting the Publishing API\nexport default function BulkPublish(props: BulkPublishProps) {\n  const {translations} = props\n  const client = useClient({apiVersion: API_VERSION})\n  const {projectId, dataset} = useWorkspace()\n  const toast = useToast()\n  const [invalidIds, setInvalidIds] = useState<string[] | null>(null)\n  const [checkedIds, setCheckedIds] = useState<string[]>([])\n\n  const onCheckComplete = useCallback((id: string) => {\n    setCheckedIds((ids) => Array.from(new Set([...ids, id])))\n  }, [])\n\n  // Handle dialog\n  const [open, setOpen] = useState(false)\n  const onOpen = useCallback(() => setOpen(true), [])\n  const onClose = useCallback(() => setOpen(false), [])\n\n  const addInvalidId = useCallback((id: string) => {\n    setInvalidIds((ids) => (ids ? Array.from(new Set([...ids, id])) : [id]))\n  }, [])\n\n  const removeInvalidId = useCallback((id: string) => {\n    setInvalidIds((ids) => (ids ? ids.filter((i) => i !== id) : []))\n  }, [])\n\n  const [draftIds, setDraftIds] = useState<string[]>([])\n\n  const addDraftId = useCallback((id: string) => {\n    setDraftIds((ids) => Array.from(new Set([...ids, id])))\n  }, [])\n\n  const removeDraftId = useCallback((id: string) => {\n    setDraftIds((ids) => ids.filter((i) => i !== id))\n  }, [])\n\n  const handleBulkPublish = useCallback(() => {\n    const body = translations.map((translation) => ({\n      documentId: translation.value._ref,\n    }))\n    client\n      .request({\n        uri: `/publish/${projectId}/${dataset}`,\n        method: 'POST',\n        body,\n      })\n      .then(() => {\n        toast.push({\n          status: 'success',\n          title: 'Success',\n          description: 'Bulk publish complete',\n        })\n      })\n      .catch((err) => {\n        console.error(err)\n        toast.push({\n          status: 'error',\n          title: 'Error',\n          description: 'Bulk publish failed',\n        })\n      })\n  }, [translations, client, projectId, dataset, toast])\n\n  const disabled =\n    // Not all documents have been checked\n    checkedIds.length !== translations.length ||\n    // Some document(s) are invalid\n    Boolean(invalidIds && invalidIds?.length > 0) ||\n    // No documents are drafts\n    !draftIds.length\n\n  return translations?.length > 0 ? (\n    <Card padding={4} border radius={2}>\n      <Stack space={3}>\n        <Inline space={3}>\n          <Text weight=\"bold\" size={1}>\n            Bulk publishing\n          </Text>\n          <Info />\n        </Inline>\n\n        <Stack>\n          <Button\n            onClick={onOpen}\n            text=\"Prepare bulk publishing\"\n            mode=\"ghost\"\n          />\n        </Stack>\n\n        {open && (\n          <Dialog\n            animate\n            header=\"Bulk publishing\"\n            id=\"bulk-publish-dialog\"\n            onClose={onClose}\n            zOffset={1000}\n            width={3}\n          >\n            <Stack space={4} padding={4}>\n              {draftIds.length > 0 ? (\n                <Stack space={2}>\n                  <Text size={1}>\n                    There{' '}\n                    {draftIds.length === 1\n                      ? `is 1 draft document`\n                      : `are ${draftIds.length} draft documents`}\n                    .\n                  </Text>\n                  {invalidIds && invalidIds.length > 0 ? (\n                    <TextWithTone tone=\"critical\" size={1}>\n                      {invalidIds && invalidIds.length === 1\n                        ? `1 draft document has`\n                        : `${\n                            invalidIds && invalidIds.length\n                          } draft documents have`}{' '}\n                      validation issues that must addressed first\n                    </TextWithTone>\n                  ) : (\n                    <TextWithTone tone=\"positive\" size={1}>\n                      All drafts are valid and can be bulk published\n                    </TextWithTone>\n                  )}\n                </Stack>\n              ) : null}\n\n              <Stack space={1}>\n                {translations\n                  .filter((translation) => translation?.value?._ref)\n                  .map((translation) => (\n                    <DocumentCheck\n                      key={translation._key}\n                      id={translation.value._ref}\n                      onCheckComplete={onCheckComplete}\n                      addInvalidId={addInvalidId}\n                      removeInvalidId={removeInvalidId}\n                      addDraftId={addDraftId}\n                      removeDraftId={removeDraftId}\n                    />\n                  ))}\n              </Stack>\n              {draftIds.length > 0 ? (\n                <Button\n                  mode=\"ghost\"\n                  tone={\n                    invalidIds && invalidIds?.length > 0\n                      ? 'caution'\n                      : 'positive'\n                  }\n                  text={\n                    draftIds.length === 1\n                      ? `Publish draft document`\n                      : `Bulk publish ${draftIds.length} draft documents`\n                  }\n                  onClick={handleBulkPublish}\n                  disabled={disabled}\n                />\n              ) : (\n                <Text muted size={1}>\n                  No draft documents to publish\n                </Text>\n              )}\n            </Stack>\n          </Dialog>\n        )}\n      </Stack>\n    </Card>\n  ) : null\n}\n", "import {useEffect} from 'react'\nimport {PatchEvent, unset, useClient, useEditState} from 'sanity'\nimport {useDocumentPane} from 'sanity/structure'\n\nimport {API_VERSION} from '../../constants'\nimport type {TranslationReference} from '../../types'\n\ntype ReferencePatcherProps = {\n  translation: TranslationReference\n  documentType: string\n  metadataId: string\n}\n\n// For every reference, check if it is published, and if so, strengthen the reference\nexport default function ReferencePatcher(props: ReferencePatcherProps) {\n  const {translation, documentType, metadataId} = props\n  const editState = useEditState(translation.value._ref, documentType)\n  const client = useClient({apiVersion: API_VERSION})\n  const {onChange} = useDocumentPane()\n\n  useEffect(() => {\n    if (\n      // We have a reference\n      translation.value._ref &&\n      // It's still weak and not-yet-strengthened\n      translation.value._weak &&\n      // We also want to keep this check because maybe the user *configured* weak refs\n      translation.value._strengthenOnPublish &&\n      // The referenced document has just been published\n      !editState.draft &&\n      editState.published &&\n      editState.ready\n    ) {\n      const referencePathBase = [\n        'translations',\n        {_key: translation._key},\n        'value',\n      ]\n\n      onChange(\n        new PatchEvent([\n          unset([...referencePathBase, '_weak']),\n          unset([...referencePathBase, '_strengthenOnPublish']),\n        ])\n      )\n    }\n  }, [translation, editState, metadataId, client, onChange])\n\n  return null\n}\n", "import type {TranslationReference} from '../../types'\nimport ReferencePatcher from './ReferencePatcher'\n\ntype OptimisticallyStrengthenProps = {\n  translations: TranslationReference[]\n  metadataId: string\n}\n\n// There's no good reason to leave published references as weak\n// So this component will run on every render and strengthen them\nexport default function OptimisticallyStrengthen(\n  props: OptimisticallyStrengthenProps\n) {\n  const {translations = [], metadataId} = props\n\n  if (!translations.length) {\n    return null\n  }\n\n  return (\n    <>\n      {translations.map((translation) =>\n        translation.value._strengthenOnPublish?.type ? (\n          <ReferencePatcher\n            key={translation._key}\n            translation={translation}\n            documentType={translation.value._strengthenOnPublish.type}\n            metadataId={metadataId}\n          />\n        ) : null\n      )}\n    </>\n  )\n}\n", "import {TranslateIcon} from '@sanity/icons'\nimport {\n  defineField,\n  defineType,\n  type DocumentDefinition,\n  type FieldDefinition,\n} from 'sanity'\n\nimport {METADATA_SCHEMA_NAME, TRANSLATIONS_ARRAY_NAME} from '../../constants'\n\nexport default (\n  schemaTypes: string[],\n  metadataFields: FieldDefinition[]\n): DocumentDefinition =>\n  defineType({\n    type: 'document',\n    name: METADATA_SCHEMA_NAME,\n    title: 'Translation metadata',\n    icon: TranslateIcon,\n    liveEdit: true,\n    fields: [\n      defineField({\n        name: TRANSLATIONS_ARRAY_NAME,\n        type: 'internationalizedArrayReference',\n      }),\n      defineField({\n        name: 'schemaTypes',\n        description:\n          'Optional: Used to filter the reference fields above so all translations share the same types.',\n        type: 'array',\n        of: [{type: 'string'}],\n        options: {list: schemaTypes},\n        readOnly: ({value}) => Boolean(value),\n      }),\n      ...metadataFields,\n    ],\n    preview: {\n      select: {\n        translations: TRANSLATIONS_ARRAY_NAME,\n        documentSchemaTypes: 'schemaTypes',\n      },\n      prepare(selection) {\n        const {translations = [], documentSchemaTypes = []} = selection\n        const title =\n          translations.length === 1\n            ? `1 Translation`\n            : `${translations.length} Translations`\n        const languageKeys = translations.length\n          ? translations\n              .map((t: {_key: string}) => t._key.toUpperCase())\n              .join(', ')\n          : ``\n        const subtitle = [\n          languageKeys ? `(${languageKeys})` : null,\n          documentSchemaTypes?.length\n            ? documentSchemaTypes.map((s: string) => s).join(`, `)\n            : ``,\n        ]\n          .filter(Boolean)\n          .join(` `)\n\n        return {\n          title,\n          subtitle,\n        }\n      },\n    },\n  })\n", "import {Stack} from '@sanity/ui'\nimport {defineField, definePlugin, isSanityDocument} from 'sanity'\nimport {internationalizedArray} from 'sanity-plugin-internationalized-array'\n\nimport {DeleteMetadataAction} from './actions/DeleteMetadataAction'\nimport {LanguageBadge} from './badges'\nimport BulkPublish from './components/BulkPublish'\nimport {DocumentInternationalizationProvider} from './components/DocumentInternationalizationContext'\nimport {DocumentInternationalizationMenu} from './components/DocumentInternationalizationMenu'\nimport OptimisticallyStrengthen from './components/OptimisticallyStrengthen'\nimport {API_VERSION, DEFAULT_CONFIG, METADATA_SCHEMA_NAME} from './constants'\nimport {documentInternationalizationUsEnglishLocaleBundle} from './i18n'\nimport metadata from './schema/translation/metadata'\nimport type {PluginConfig, TranslationReference} from './types'\n\nexport const documentInternationalization = definePlugin<PluginConfig>(\n  (config) => {\n    const pluginConfig = {...DEFAULT_CONFIG, ...config}\n    const {\n      supportedLanguages,\n      schemaTypes,\n      languageField,\n      bulkPublish,\n      metadataFields,\n    } = pluginConfig\n\n    if (schemaTypes.length === 0) {\n      throw new Error(\n        'You must specify at least one schema type on which to enable document internationalization. Update the `schemaTypes` option in the documentInternationalization() configuration.'\n      )\n    }\n\n    return {\n      name: '@sanity/document-internationalization',\n\n      studio: {\n        components: {\n          layout: (props) =>\n            DocumentInternationalizationProvider({...props, pluginConfig}),\n        },\n      },\n\n      i18n: {\n        bundles: [documentInternationalizationUsEnglishLocaleBundle],\n      },\n\n      // Adds:\n      // - A bulk-publishing UI component to the form\n      // - Will only work for projects on a compatible plan\n      form: {\n        components: {\n          input: (props) => {\n            if (\n              props.id === 'root' &&\n              props.schemaType.name === METADATA_SCHEMA_NAME &&\n              isSanityDocument(props?.value)\n            ) {\n              const metadataId = props?.value?._id\n              const translations =\n                (props?.value?.translations as TranslationReference[]) ?? []\n              const weakAndTypedTranslations = translations.filter(\n                ({value}) => value?._weak && value._strengthenOnPublish\n              )\n\n              return (\n                <Stack space={5}>\n                  {bulkPublish ? (\n                    <BulkPublish translations={translations} />\n                  ) : null}\n                  {weakAndTypedTranslations.length > 0 ? (\n                    <OptimisticallyStrengthen\n                      metadataId={metadataId}\n                      translations={weakAndTypedTranslations}\n                    />\n                  ) : null}\n                  {props.renderDefault(props)}\n                </Stack>\n              )\n            }\n\n            return props.renderDefault(props)\n          },\n        },\n      },\n\n      // Adds:\n      // - The `Translations` dropdown to the editing form\n      // - `Badges` to documents with a language value\n      // - The `DeleteMetadataAction` action to the metadata document type\n      document: {\n        unstable_languageFilter: (prev, ctx) => {\n          const {schemaType, documentId} = ctx\n\n          return schemaTypes.includes(schemaType) && documentId\n            ? [\n                ...prev,\n                (props) =>\n                  DocumentInternationalizationMenu({...props, documentId}),\n              ]\n            : prev\n        },\n        badges: (prev, {schemaType}) => {\n          if (!schemaTypes.includes(schemaType)) {\n            return prev\n          }\n\n          return [(props) => LanguageBadge(props), ...prev]\n        },\n        actions: (prev, {schemaType}) => {\n          if (schemaType === METADATA_SCHEMA_NAME) {\n            return [...prev, DeleteMetadataAction]\n          }\n\n          return prev\n        },\n      },\n\n      // Adds:\n      // - The `Translations metadata` document type to the schema\n      schema: {\n        // Create the metadata document type\n        types: [metadata(schemaTypes, metadataFields)],\n\n        // For every schema type this plugin is enabled on\n        // Create an initial value template to set the language\n        templates: (prev, {schema}) => {\n          // Templates are not setup for async languages\n          if (!Array.isArray(supportedLanguages)) {\n            return prev\n          }\n\n          const parameterizedTemplates = schemaTypes.map((schemaType) => ({\n            id: `${schemaType}-parameterized`,\n            title: `${\n              schema?.get(schemaType)?.title ?? schemaType\n            }: with Language`,\n            schemaType,\n            parameters: [\n              {name: `languageId`, title: `Language ID`, type: `string`},\n            ],\n            value: ({languageId}: {languageId: string}) => ({\n              [languageField]: languageId,\n            }),\n          }))\n\n          const staticTemplates = schemaTypes.flatMap((schemaType) => {\n            return supportedLanguages.map((language) => ({\n              id: `${schemaType}-${language.id}`,\n              title: `${language.title} ${\n                schema?.get(schemaType)?.title ?? schemaType\n              }`,\n              schemaType,\n              value: {\n                [languageField]: language.id,\n              },\n            }))\n          })\n\n          return [...prev, ...parameterizedTemplates, ...staticTemplates]\n        },\n      },\n\n      // Uses:\n      // - `sanity-plugin-internationalized-array` to maintain the translations array\n      plugins: [\n        // Translation metadata stores its references using this plugin\n        // It cuts down on attribute usage and gives UI conveniences to add new translations\n        internationalizedArray({\n          languages: supportedLanguages,\n          fieldTypes: [\n            defineField(\n              {\n                name: 'reference',\n                type: 'reference',\n                to: schemaTypes.map((type) => ({type})),\n                weak: pluginConfig.weakReferences,\n                // Reference filters don't actually enforce validation!\n                validation: (Rule) =>\n                  // @ts-expect-error - fix typings\n                  Rule.custom(async (item: TranslationReference, context) => {\n                    if (!item?.value?._ref || !item?._key) {\n                      return true\n                    }\n\n                    const client = context.getClient({apiVersion: API_VERSION})\n                    const valueLanguage = await client.fetch(\n                      `*[_id in [$ref, $draftRef]][0].${languageField}`,\n                      {\n                        ref: item.value._ref,\n                        draftRef: `drafts.${item.value._ref}`,\n                      }\n                    )\n\n                    if (valueLanguage && valueLanguage === item._key) {\n                      return true\n                    }\n\n                    return `Referenced document does not have the correct language value`\n                  }),\n                options: {\n                  // @ts-expect-error - Update type once it knows the values of this filter\n                  filter: ({parent, document}) => {\n                    if (!parent) return null\n\n                    // I'm not sure in what instance there's an array of parents\n                    // But the Type suggests it's possible\n                    const parentArray = Array.isArray(parent)\n                      ? parent\n                      : [parent]\n                    const language = parentArray.find((p) => p._key)\n\n                    if (!language?._key) return null\n\n                    if (document.schemaTypes) {\n                      return {\n                        filter: `_type in $schemaTypes && ${languageField} == $language`,\n                        params: {\n                          schemaTypes: document.schemaTypes,\n                          language: language._key,\n                        },\n                      }\n                    }\n\n                    return {\n                      filter: `${languageField} == $language`,\n                      params: {language: language._key},\n                    }\n                  },\n                },\n              },\n              {strict: false}\n            ),\n          ],\n        }),\n      ],\n    }\n  }\n)\n"],
  "mappings": "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",
  "names": ["equal", "a", "i", "__spreadValues", "__spreadValues", "__spreadValues", "__spreadValues", "parseAssetId_1", "parseAssetId", "this", "t", "s", "i", "n", "parseSource_1", "parseSource", "require$$0", "require$$1", "urlForImage", "o", "k", "k2", "ImageUrlBuilder", "query", "isEqual", "equal", "a", "i", "preload", "config", "entry", "defaultFilterField", "enclosingType", "field", "selectedLanguageIds", "name", "startsWith", "includes", "isLanguageFilterEnabled", "schemaType", "options", "_a", "_b", "schemaFilter", "jsonType", "getRootType", "languageFilter", "defaultEnabled", "documentTypes", "schema", "type", "storageKey", "getPersistedLanguageIds", "selectableLangs", "getSelectableLanguages", "map", "l", "id", "selected", "persistedValue", "window", "localStorage", "getItem", "JSON", "parse", "err", "array2", "filter", "value", "supportedLanguages", "defaultLanguages", "Array", "isArray", "lang", "e", "t", "n", "defaultContextValue", "apiVersion", "filterField", "setSelectedLanguageIds", "console", "error", "LanguageFilterStudioContext", "createContext", "LanguageFilterStudioProvider", "props", "client", "useClient", "languages", "setLanguages", "useState", "useEffect", "asyncLanguages", "async", "supportedLanguagesCallback", "useMemo", "__spreadProps", "jsx", "Provider", "children", "renderDefault", "useLanguageFilterStudioContext", "useContext", "unique", "arr", "from", "Set", "usePaneLanguages", "selectableLanguages", "updateSelectedIds", "useCallback", "ids", "languageIds", "setItem", "stringify", "selectAll", "selectNone", "toggleLanguage", "languageId", "activeLanguages", "allSelected", "length", "StyledBox", "styled", "Box", "LanguageFilterMenuButton", "languageOptions", "open", "setOpen", "button", "setButton", "popover", "setPopover", "handleToggleAll", "event", "currentTarget", "handleClick", "o", "handleClickOutside", "useClickOutside", "langCount", "query", "setQuery", "handleQuery", "showSearch", "content", "overflow", "jsxs", "Stack", "padding", "space", "Fragment", "LanguageFilterOption", "title", "Card", "borderTop", "Button", "mode", "onClick", "justify", "disabled", "Flex", "gap", "align", "Text", "size", "TextWithTone", "tone", "EyeClosedIcon", "EyeOpenIcon", "flex", "TextInput", "onChange", "placeholder", "language", "toLowerCase", "onToggle", "buttonText", "Popover", "animate", "portal", "ref", "text", "icon", "TranslateIcon", "handleChange", "CheckmarkCircleIcon", "CircleIcon", "Badge", "r", "FilteredObjectInput", "members", "membersProp", "restProps", "__objRest", "member", "kind", "__spreadValues", "fieldSet", "fieldsetMember", "definePlugin", "RenderLanguageFilter", "pluginOptions", "studio", "components", "layout", "document", "unstable_languageFilter", "prev", "get", "form", "input", "isObjectSchemaType", "documentType", "useFormValue", "useSchema", "preload", "peek", "__spreadProps", "AddButtons", "get", "__spreadValues", "internationalizedArray", "suspend", "equal", "l", "preload", "config", "r", "Feedback", "a", "isPromise", "globalCache", "shallowEqualArrays", "equal", "a", "i", "query", "preload", "config", "entry", "suspend", "__spreadProps", "__spreadValues", "d", "b", "o", "s", "n", "r", "e", "l", "Subscription", "Subscriber", "ConsumerObserver", "SafeSubscriber", "OperatorSubscriber", "err", "dupeId", "t", "metadata", "_a", "__defProp", "__defProps", "__getOwnPropDescs", "__getOwnPropSymbols", "__hasOwnProp", "__propIsEnum", "__defNormalProp"]
}
